"use strict";(self.webpackChunkmi_app_lectura=self.webpackChunkmi_app_lectura||[]).push([[179],{8179:(t,r,e)=>{e.r(r),e.d(r,{cleanupOldActivityData:()=>n,hasPendingMigration:()=>s,migrateActivityDataToContext:()=>i});const a="activity_results_",o="activitiesProgress";function i(){try{console.log("\ud83d\udd04 [Migration] Iniciando migraci\xf3n de datos de actividades...");const r=Object.keys(localStorage).filter((t=>t.startsWith(a)));if(0===r.length)return console.log("\u2139\ufe0f [Migration] No hay datos antiguos para migrar"),{migrated:0,errors:0,data:{}};console.log(`\ud83d\udcca [Migration] Encontrados ${r.length} documentos a migrar`);let e={};try{const t=localStorage.getItem(o);t&&(e=JSON.parse(t))}catch(t){console.warn("\u26a0\ufe0f [Migration] Error cargando activitiesProgress existente:",t)}let i=0,n=0;return r.forEach((t=>{try{var r;const o=t.replace(a,""),n=localStorage.getItem(t),s=(null===(r=JSON.parse(n).data)||void 0===r?void 0:r.student_answers)||{},c=s.mcq,l=s.synthesis,g={preparation:{mcqPassed:(null===c||void 0===c?void 0:c.passed)||!1,mcqResults:c||null,completed:!!l,synthesisAnswers:l||null,migratedFrom:"useActivityPersistence",migratedAt:Date.now()}};e[o]=g,console.log(`\u2705 [Migration] Migrado documento: ${o}`),i++}catch(o){console.error(`\u274c [Migration] Error migrando ${t}:`,o),n++}})),localStorage.setItem(o,JSON.stringify(e)),console.log(`\u2705 [Migration] Migraci\xf3n completada: ${i} exitosos, ${n} errores`),{migrated:i,errors:n,data:e}}catch(r){return console.error("\u274c [Migration] Error fatal en migraci\xf3n:",r),{migrated:0,errors:1,data:{}}}}function n(){try{const t=Object.keys(localStorage).filter((t=>t.startsWith(a)));return t.forEach((t=>localStorage.removeItem(t))),localStorage.removeItem(`${a}index`),console.log(`\ud83d\uddd1\ufe0f [Migration] ${t.length} entradas antiguas eliminadas`),t.length}catch(t){return console.error("\u274c [Migration] Error limpiando datos antiguos:",t),0}}function s(){return Object.keys(localStorage).filter((t=>t.startsWith(a))).length>0}}}]);