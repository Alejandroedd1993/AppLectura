"use strict";(self.webpackChunkmi_app_lectura=self.webpackChunkmi_app_lectura||[]).push([[304],{2304:(e,t,o)=>{o.r(t),o.d(t,{default:()=>fe});var r=o(9950),a=o(387),i=o(5803),n=o(6275);const s=new class{constructor(){this.cache=new Map,this.maxRetries=3,this.retryDelay=2e3,this.maxTokensInput=4e3,this.maxTokensOutput=1e3}getClient(){try{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"https://applectura-backend.onrender.com",REACT_APP_FIREBASE_API_KEY:"AIzaSyAzh5Qqiend6CSZzzCu6aUm4V9r17X42Ic",REACT_APP_FIREBASE_APP_ID:"1:522981088704:web:4d58bbb7f74ca661ccbc25",REACT_APP_FIREBASE_AUTH_DOMAIN:"applectura-cb058.firebaseapp.com",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"522981088704",REACT_APP_FIREBASE_PROJECT_ID:"applectura-cb058",REACT_APP_FIREBASE_STORAGE_BUCKET:"applectura-cb058.firebasestorage.app",REACT_APP_PORT:"3000",REACT_APP_SERPER_API_KEY:"",REACT_APP_TAVILY_API_KEY:"configured"}.REACT_APP_OPENAI_API_KEY||localStorage.getItem("user_openai_api_key");if(!e)throw new Error("No se encontr\xf3 una clave API de OpenAI. Por favor, configura tu API key.");return new n.z4({apiKey:e,dangerouslyAllowBrowser:!0})}catch(e){throw console.error("Error al inicializar OpenAI:",e),new Error(`Error de configuraci\xf3n: ${e.message}`)}}generateCacheKey(e,t){if(!t)return"";let o=0;const r=t.substring(0,200);for(let a=0;a<r.length;a++){o=(o<<5)-o+r.charCodeAt(a),o|=0}return`${e}_${Math.abs(o)}_${t.length}`}limitTextForAPI(e){if(!e)return"";const t=4*this.maxTokensInput;return e.length<=t?e:e.substring(0,t)+"..."}async callWithRetry(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"API call";for(let a=1;a<=this.maxRetries;a++)try{return console.log(`[OpenAI] ${o} - Intento ${a}/${this.maxRetries}`),await e()}catch(r){if(t=r,console.warn(`[OpenAI] ${o} fall\xf3 en intento ${a}:`,r.message),a===this.maxRetries)break;const e=this.retryDelay*Math.pow(2,a-1);console.log(`[OpenAI] Esperando ${e}ms antes del siguiente intento...`),await new Promise((t=>setTimeout(t,e)))}throw new Error(`${o} fall\xf3 despu\xe9s de ${this.maxRetries} intentos: ${t.message}`)}async detectarTipoTexto(e){if(!e||0===e.trim().length)throw new Error("No hay texto para analizar");const t=this.generateCacheKey("tipo",e);if(this.cache.has(t))return console.log("[OpenAI] Usando tipo de texto desde cach\xe9"),this.cache.get(t);const o=`Analiza el siguiente texto y determina si es principalmente narrativo, po\xe9tico, filos\xf3fico o ensayo.\n\nINSTRUCCIONES:\n- Responde SOLO con una de estas palabras exactas: "narrativo", "poetico", "filosofico", "ensayo"\n- No agregues explicaciones ni comentarios adicionales\n- Considera las caracter\xedsticas principales del texto\n\nTEXTO A ANALIZAR:\n${this.limitTextForAPI(e)}`;try{const e=await this.callWithRetry((async()=>{const e=this.getClient();return(await e.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:o}],temperature:.3,max_tokens:50})).choices[0].message.content}),"Detecci\xf3n de tipo de texto"),r=e.toLowerCase().trim();return["narrativo","poetico","filosofico","ensayo"].includes(r)?(this.cache.set(t,r),console.log(`[OpenAI] Tipo detectado: ${r}`),r):(console.warn(`[OpenAI] Tipo no reconocido: "${r}", usando "narrativo" por defecto`),"narrativo")}catch(r){throw console.error("[OpenAI] Error en detecci\xf3n de tipo:",r),new Error(`No se pudo detectar el tipo de texto: ${r.message}`)}}getPromptForTextType(e){const t={narrativo:'Crea notas de estudio concisas para aprendizaje espaciado sobre este texto narrativo.\n\nESTRUCTURA REQUERIDA (JSON):\n{\n  "tipoTexto": "narrativo",\n  "titulo": "T\xedtulo del texto o obra",\n  "personajes": [{"nombre": "Nombre", "descripcion": "Caracter\xedsticas esenciales"}],\n  "espacioTiempo": "Ubicaci\xf3n y \xe9poca de la narrativa",\n  "vozNarrativa": "Tipo de narrador (primera persona, tercera persona, etc.)",\n  "temas": ["Tema principal", "Subtemas importantes"],\n  "estructura": {\n    "inicio": "Situaci\xf3n inicial y presentaci\xf3n",\n    "desarrollo": "Conflicto y complicaciones",\n    "desenlace": "Resoluci\xf3n y final"\n  },\n  "simbolos": [{"simbolo": "Elemento simb\xf3lico", "significado": "Interpretaci\xf3n"}],\n  "conceptosClave": ["Concepto 1", "Concepto 2", "Concepto 3"]\n}',poetico:'Crea notas de estudio concisas para aprendizaje espaciado sobre este texto po\xe9tico.\n\nESTRUCTURA REQUERIDA (JSON):\n{\n  "tipoTexto": "poetico",\n  "titulo": "T\xedtulo del poema o composici\xf3n",\n  "objetoPoetico": "Tema central o motivo l\xedrico",\n  "recursosLiterarios": [{"recurso": "Tipo de recurso", "ejemplo": "Ejemplo del texto", "efecto": "Efecto producido"}],\n  "metricaRima": "Descripci\xf3n t\xe9cnica de m\xe9trica y rima",\n  "tonoAtmosfera": "Tono emotivo y atm\xf3sfera del poema",\n  "interpretacion": "Interpretaci\xf3n general del significado",\n  "conceptosClave": ["Concepto 1", "Concepto 2", "Concepto 3"]\n}',filosofico:'Crea notas de estudio concisas para aprendizaje espaciado sobre este texto filos\xf3fico.\n\nESTRUCTURA REQUERIDA (JSON):\n{\n  "tipoTexto": "filosofico",\n  "titulo": "T\xedtulo o tema principal del texto",\n  "ideasFundamentales": ["Ideas centrales del autor"],\n  "preguntasClave": ["Preguntas filos\xf3ficas que plantea"],\n  "argumentos": [{"premisa": "Premisa del argumento", "conclusion": "Conclusi\xf3n l\xf3gica"}],\n  "corrienteFilosofica": "Escuela o corriente filos\xf3fica",\n  "conceptosEsenciales": [{"concepto": "T\xe9rmino filos\xf3fico", "definicion": "Definici\xf3n clara"}],\n  "conceptosClave": ["Concepto 1", "Concepto 2", "Concepto 3"]\n}',ensayo:'Crea notas de estudio concisas para aprendizaje espaciado sobre este ensayo.\n\nESTRUCTURA REQUERIDA (JSON):\n{\n  "tipoTexto": "ensayo",\n  "titulo": "T\xedtulo del ensayo",\n  "tesisPrincipal": "Enunciado claro de la tesis",\n  "ideasSecundarias": ["Ideas que apoyan la tesis"],\n  "evidencia": [{"tipo": "Tipo de evidencia", "descripcion": "Descripci\xf3n de la evidencia"}],\n  "estructuraLogica": ["Secuencia l\xf3gica de argumentos"],\n  "conclusiones": ["Conclusiones principales"],\n  "conceptosClave": ["Concepto 1", "Concepto 2", "Concepto 3"]\n}'};return t[e]||t.ensayo}async generarNotasSegunTipo(e,t){if(!e||0===e.trim().length)throw new Error("No hay texto para analizar");const o=this.generateCacheKey(`notas_${t}`,e);if(this.cache.has(o))return console.log("[OpenAI] Usando notas desde cach\xe9"),this.cache.get(o);const r=`${this.getPromptForTextType(t)}\n\nINSTRUCCIONES IMPORTANTES:\n- Responde \xdaNICAMENTE con el JSON solicitado\n- No agregues comentarios, explicaciones o texto adicional\n- Aseg\xfarate de que el JSON sea v\xe1lido\n- S\xe9 conciso pero informativo en cada campo\n\nTEXTO A ANALIZAR:\n${this.limitTextForAPI(e)}`;try{const e=await this.callWithRetry((async()=>{const e=this.getClient();return(await e.chat.completions.create({model:"gpt-3.5-turbo",messages:[{role:"user",content:r}],temperature:.7,max_tokens:this.maxTokensOutput})).choices[0].message.content}),`Generaci\xf3n de notas (${t})`),a=this.parseNotasResponse(e,t);return this.cache.set(o,a),console.log(`[OpenAI] Notas generadas exitosamente para tipo: ${t}`),a}catch(a){throw console.error("[OpenAI] Error al generar notas:",a),new Error(`Error al generar notas de estudio: ${a.message}`)}}parseNotasResponse(e,t){try{const o=e.match(/\{[\s\S]*\}/),r=o?o[0]:e,a=JSON.parse(r);return a.tipoTexto||(a.tipoTexto=t),a.titulo||(a.titulo="An\xe1lisis de texto"),a.conceptosClave&&Array.isArray(a.conceptosClave)||(a.conceptosClave=[]),a}catch(o){return console.error("[OpenAI] Error al parsear JSON:",o),console.log("[OpenAI] Respuesta recibida:",e),{tipoTexto:t,titulo:"Error al procesar notas",error:"No se pudo procesar la respuesta en formato JSON",respuestaOriginal:e,conceptosClave:[]}}}clearCache(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){Array.from(this.cache.keys()).filter((t=>t.startsWith(e))).forEach((e=>this.cache.delete(e))),console.log(`[OpenAI] Cache limpiado para prefijo: ${e}`)}else this.cache.clear(),console.log("[OpenAI] Cache completamente limpiado")}getCacheStats(){return{totalEntries:this.cache.size,entries:Array.from(this.cache.keys()).reduce(((e,t)=>{const o=t.split("_")[0];return e[o]=(e[o]||0)+1,e}),{})}}};const l=new class{constructor(){this.intervalosBase=[0,1,3,6,13,29,60],this.configuracionDefecto={duracionMinima:7,duracionMaxima:90,intervalosPersonalizados:null}}generarCronograma(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e<this.configuracionDefecto.duracionMinima)throw new Error(`La duraci\xf3n m\xednima es ${this.configuracionDefecto.duracionMinima} d\xedas`);if(e>this.configuracionDefecto.duracionMaxima)throw new Error(`La duraci\xf3n m\xe1xima es ${this.configuracionDefecto.duracionMaxima} d\xedas`);const o=t?new Date(t):new Date,r=[],a=this.intervalosBase.filter((t=>t<e));a.forEach(((e,t)=>{const i=new Date(o);i.setDate(o.getDate()+e);const n={numero:t+1,dias:e,fecha:i,fechaISO:i.toISOString(),completado:!1,descripcion:this.generarDescripcionRepaso(t+1,e),importancia:this.calcularImportancia(t+1,a.length),efectividad:this.calcularEfectividad(e),tipo:this.determinarTipoRepaso(t+1)};r.push(n)}));const i={cronograma:r,metadatos:{duracionTotal:e,fechaInicio:o.toISOString(),totalRepasos:r.length,algoritmo:"Curva del Olvido de Ebbinghaus",version:"1.0.0",creado:(new Date).toISOString()}};return console.log(`[CronogramaService] Cronograma generado: ${r.length} repasos en ${e} d\xedas`),i}generarDescripcionRepaso(e,t){return{1:"Estudio inicial - Primera lectura completa",2:"Primer repaso - Refuerzo inmediato",3:"Segundo repaso - Consolidaci\xf3n temprana",4:"Tercer repaso - Afianzamiento",5:"Cuarto repaso - Retenci\xf3n intermedia",6:"Quinto repaso - Consolidaci\xf3n avanzada",7:"Repaso final - Retenci\xf3n a largo plazo"}[e]||`Repaso ${e} - D\xeda ${t}`}calcularImportancia(e,t){return 1===e?"cr\xedtica":2===e?"muy alta":e<=3?"alta":e<=.7*t?"media":"mantenimiento"}calcularEfectividad(e){return 0===e?100:1===e?95:e<=3?85:e<=7?75:e<=14?65:e<=30?55:45}determinarTipoRepaso(e){return{1:"inicial",2:"refuerzo",3:"consolidacion",4:"afianzamiento",5:"intermedio",6:"avanzado",7:"final"}[e]||"mantenimiento"}esRepasoDeHoy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=t?new Date(t):new Date,r=new Date(e.fecha);return o.getFullYear()===r.getFullYear()&&o.getMonth()===r.getMonth()&&o.getDate()===r.getDate()}getRepasosPendientesHoy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.filter((e=>!e.completado&&this.esRepasoDeHoy(e,t)))}getRepasosVencidos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=t?new Date(t):new Date;return e.filter((e=>{const t=new Date(e.fecha);return!e.completado&&t<o}))}calcularEstadisticasProgreso(e){const t=e.length,o=e.filter((e=>e.completado)).length,r=t-o,a=t>0?o/t*100:0,i=new Date,n=this.getRepasosVencidos(e,i),s=this.getRepasosPendientesHoy(e,i);return{total:t,completados:o,pendientes:r,porcentajeCompletado:Math.round(10*a)/10,vencidos:n.length,paraHoy:s.length,proximoRepaso:this.getProximoRepaso(e),estado:this.determinarEstadoGeneral(a,n.length)}}getProximoRepaso(e){const t=e.filter((e=>!e.completado)).sort(((e,t)=>new Date(e.fecha)-new Date(t.fecha)));return t.length>0?t[0]:null}determinarEstadoGeneral(e,t){return 100===e?"completado":t>2?"atrasado":t>0?"con-retrasos":e>=75?"avanzado":e>=50?"en-progreso":e>=25?"iniciado":"no-iniciado"}marcarRepasoCompletado(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t<0||t>=e.length)throw new Error("\xcdndice de repaso inv\xe1lido");const r=e[t];return r.completado=!0,r.fechaCompletado=(o||new Date).toISOString(),console.log(`[CronogramaService] Repaso ${r.numero} marcado como completado`),r}resetearCronograma(e){return e.forEach((e=>{e.completado=!1,delete e.fechaCompletado})),console.log("[CronogramaService] Cronograma reseteado"),e}exportarCronograma(e){return JSON.stringify(e,null,2)}importarCronograma(e){try{const t=JSON.parse(e);if(!t.cronograma||!Array.isArray(t.cronograma))throw new Error("Formato de cronograma inv\xe1lido");return t.cronograma.forEach((e=>{e.fechaISO&&(e.fecha=new Date(e.fechaISO)),e.fechaCompletado&&(e.fechaCompletado=new Date(e.fechaCompletado))})),console.log("[CronogramaService] Cronograma importado exitosamente"),t}catch(t){throw console.error("[CronogramaService] Error al importar cronograma:",t),new Error(`Error al importar cronograma: ${t.message}`)}}};const d={OpenAI:s,Cronograma:l,Storage:new class{constructor(){this.keys={NOTAS_PROGRESO:"notas_estudio_progreso",CONFIGURACION:"notas_estudio_config",CACHE_TEMPORAL:"notas_estudio_cache",API_KEY:"user_openai_api_key",ESTADISTICAS:"notas_estudio_stats"},this.defaultConfig={tipoTexto:"auto",duracionEstudio:30,notificaciones:!0,modoOscuro:!1,autoguardado:!0},this.limits={MAX_ENTRIES:50,MAX_CACHE_AGE:6048e5,MAX_STORAGE_SIZE:5242880}}generarIdTexto(e){if(!e)return"";let t=0;const o=e.substring(0,500);for(let a=0;a<o.length;a++){t=(t<<5)-t+o.charCodeAt(a),t|=0}const r=Date.now();return`texto_${Math.abs(t)}_${r}`}isStorageAvailable(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return console.warn("[StorageService] localStorage no disponible:",e),!1}}saveData(e,t){if(!this.isStorageAvailable())return console.warn("[StorageService] No se puede guardar, localStorage no disponible"),!1;try{const o={data:t,timestamp:Date.now(),version:"1.0.0"},r=JSON.stringify(o);return r.length>this.limits.MAX_STORAGE_SIZE?(console.warn("[StorageService] Datos demasiado grandes para guardar"),!1):(localStorage.setItem(e,r),console.log(`[StorageService] Datos guardados exitosamente: ${e}`),!0)}catch(o){if(console.error("[StorageService] Error al guardar datos:",o),"QuotaExceededError"===o.name){this.cleanOldCache();try{return localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now()})),!0}catch(r){console.error("[StorageService] Error en segundo intento:",r)}}return!1}}loadData(e){if(!this.isStorageAvailable())return null;try{const t=localStorage.getItem(e);if(!t)return null;const o=JSON.parse(t);return void 0!==o.data&&void 0!==o.timestamp?o.data:o}catch(t){return console.error(`[StorageService] Error al cargar datos para ${e}:`,t),null}}guardarProgresoNotas(e,t){const o=this.generarIdTexto(e),r=this.cargarTodoProgreso();return r[o]={...t,idTexto:o,textoHash:this.generarHashTexto(e),ultimaActualizacion:Date.now(),version:"1.0.0"},this.cleanOldEntries(r),this.saveData(this.keys.NOTAS_PROGRESO,r)}cargarProgresoNotas(e){const t=this.generarIdTexto(e),o=this.cargarTodoProgreso();if(o[t])return console.log(`[StorageService] Progreso cargado para texto: ${t}`),o[t];const r=this.generarHashTexto(e),a=Object.values(o).find((e=>e.textoHash===r));return a?(console.log(`[StorageService] Progreso encontrado por hash: ${r}`),a):null}cargarTodoProgreso(){return this.loadData(this.keys.NOTAS_PROGRESO)||{}}generarHashTexto(e){if(!e)return"";let t=0;for(let o=0;o<e.length;o++){t=(t<<5)-t+e.charCodeAt(o),t|=0}return Math.abs(t).toString(36)}guardarConfiguracion(e){const t={...this.defaultConfig,...e,ultimaModificacion:Date.now()};return this.saveData(this.keys.CONFIGURACION,t)}cargarConfiguracion(){const e=this.loadData(this.keys.CONFIGURACION);return e?{...this.defaultConfig,...e}:this.defaultConfig}guardarEstadisticas(e){const t={...this.cargarEstadisticas(),...e,ultimaActualizacion:Date.now()};return this.saveData(this.keys.ESTADISTICAS,t)}cargarEstadisticas(){return this.loadData(this.keys.ESTADISTICAS)||{textosAnalizados:0,notasGeneradas:0,repasosCompletados:0,tiempoTotalEstudio:0}}cleanOldEntries(e){const t=Object.entries(e);if(t.length<=this.limits.MAX_ENTRIES)return;const o=t.sort(((e,t)=>{const o=e[1].ultimaActualizacion||0;return(t[1].ultimaActualizacion||0)-o})).slice(0,this.limits.MAX_ENTRIES);Object.keys(e).forEach((t=>delete e[t])),o.forEach((t=>{let[o,r]=t;e[o]=r})),console.log(`[StorageService] Limpiadas ${t.length-o.length} entradas antiguas`)}cleanOldCache(){const e=this.loadData(this.keys.CACHE_TEMPORAL)||{},t=Date.now();let o=0;return Object.keys(e).forEach((r=>{const a=e[r];a.timestamp&&t-a.timestamp>this.limits.MAX_CACHE_AGE&&(delete e[r],o++)})),o>0&&(this.saveData(this.keys.CACHE_TEMPORAL,e),console.log(`[StorageService] Limpiadas ${o} entradas de cache antiguas`)),o}getStorageInfo(){if(!this.isStorageAvailable())return{available:!1};let e=0,t=0;const o={};try{for(let r in localStorage)if(localStorage.hasOwnProperty(r)){const a=localStorage.getItem(r),i=a?a.length:0;e+=i,t++,r.startsWith("notas_estudio_")&&(o[r]={size:i,sizeKB:Math.round(i/1024*100)/100})}return{available:!0,totalSize:e,totalSizeKB:Math.round(e/1024*100)/100,totalSizeMB:Math.round(e/1048576*100)/100,itemCount:t,notasEstudioItems:o,limiteUtilizado:Math.round(e/this.limits.MAX_STORAGE_SIZE*100)}}catch(r){return console.error("[StorageService] Error al obtener informaci\xf3n de almacenamiento:",r),{available:!0,error:r.message}}}exportarTodosDatos(){return{progreso:this.cargarTodoProgreso(),configuracion:this.cargarConfiguracion(),estadisticas:this.cargarEstadisticas(),exportado:(new Date).toISOString(),version:"1.0.0"}}importarDatos(e){try{let t=0;return e.progreso&&(this.saveData(this.keys.NOTAS_PROGRESO,e.progreso),t++),e.configuracion&&(this.saveData(this.keys.CONFIGURACION,e.configuracion),t++),e.estadisticas&&(this.saveData(this.keys.ESTADISTICAS,e.estadisticas),t++),console.log(`[StorageService] ${t} conjuntos de datos importados exitosamente`),!0}catch(t){return console.error("[StorageService] Error al importar datos:",t),!1}}limpiarTodosDatos(){let e=0;return Object.values(this.keys).forEach((t=>{localStorage.getItem(t)&&(localStorage.removeItem(t),e++)})),console.log(`[StorageService] ${e} elementos eliminados`),e}}},c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const[o,a]=(0,r.useState)(null),[n,s]=(0,r.useState)([]),[l,c]=(0,r.useState)({}),[m,g]=(0,r.useState)("auto"),[p,h]=(0,r.useState)(30),[u,x]=(0,r.useState)((()=>localStorage.getItem("nivel_academico")||"pregrado")),[f,y]=(0,r.useState)(!1),[b,v]=(0,r.useState)(""),[j,S]=(0,r.useState)(!1),[C,$]=(0,r.useState)("");(0,r.useEffect)((()=>{localStorage.setItem("nivel_academico",u)}),[u]);const w=(0,r.useCallback)((e=>e?d.Storage.generarIdTexto(e):""),[]),E=(0,r.useCallback)((()=>{try{const e=d.Storage.cargarConfiguracion();e.tipoTexto&&g(e.tipoTexto),e.duracionEstudio&&h(e.duracionEstudio),console.log("[useNotasEstudio] Configuraci\xf3n inicial cargada")}catch(b){console.error("[useNotasEstudio] Error al cargar configuraci\xf3n inicial:",b)}}),[]),T=(0,r.useCallback)((async e=>{if(e)try{const t=d.Storage.cargarProgresoNotas(e);if(t){if(console.log("[useNotasEstudio] Datos guardados encontrados"),t.notas&&a(t.notas),t.cronograma){s(t.cronograma);const e={};t.cronograma.forEach(((t,o)=>{t.completado&&(e[o]=!0)})),c(e)}t.tipoTexto&&g(t.tipoTexto),t.duracionEstudio&&h(t.duracionEstudio)}}catch(b){console.error("[useNotasEstudio] Error al cargar datos guardados:",b)}}),[]),A=(0,r.useCallback)(((t,r)=>{if(e)try{const a={notas:t||o,cronograma:r||n,tipoTexto:m,duracionEstudio:p,notasRepasadas:l,ultimaActualizacion:Date.now()};d.Storage.guardarProgresoNotas(e,a)?console.log("[useNotasEstudio] Progreso guardado exitosamente"):console.warn("[useNotasEstudio] No se pudo guardar el progreso")}catch(b){console.error("[useNotasEstudio] Error al guardar progreso:",b)}}),[e,o,n,m,p,l]),_=((0,r.useCallback)((async(e,t)=>{if(!e)throw new Error("No hay texto para analizar");try{console.log(`[useNotasEstudio] Generando notas para tipo: ${t}`);let o=t;"auto"===t&&(o=await d.OpenAI.detectarTipoTexto(e),console.log(`[useNotasEstudio] Tipo detectado autom\xe1ticamente: ${o}`));return await d.OpenAI.generarNotasSegunTipo(e,o)}catch(b){throw console.error("[useNotasEstudio] Error al generar notas:",b),b}}),[]),(0,r.useCallback)((e=>{try{return d.Cronograma.generarCronograma(e).cronograma}catch(b){throw console.error("[useNotasEstudio] Error al generar cronograma:",b),b}}),[])),k=(0,r.useCallback)((e=>{var t,o,r,a,i,n,s,l,d,c,m,g,p,h,u,x,f,y,b,v,j,S,C,$,w,E,T,A;if(!e)return null;const _={genero:(null===e||void 0===e||null===(t=e.prelecture)||void 0===t||null===(o=t.metadata)||void 0===o?void 0:o.genero_textual)||(null===e||void 0===e||null===(r=e.metadata)||void 0===r?void 0:r.genero_textual),proposito:null===e||void 0===e||null===(a=e.prelecture)||void 0===a||null===(i=a.metadata)||void 0===i?void 0:i.proposito_comunicativo,audiencia:null===e||void 0===e||null===(n=e.prelecture)||void 0===n||null===(s=n.metadata)||void 0===s?void 0:s.audiencia_objetivo,tipologia:null===e||void 0===e||null===(l=e.prelecture)||void 0===l||null===(d=l.metadata)||void 0===d?void 0:d.tipologia_textual,tesis_central:null===e||void 0===e||null===(c=e.prelecture)||void 0===c||null===(m=c.argumentation)||void 0===m?void 0:m.tesis_central,argumentos_principales:null===e||void 0===e||null===(g=e.prelecture)||void 0===g||null===(p=g.argumentation)||void 0===p||null===(h=p.argumentos_principales)||void 0===h?void 0:h.map((e=>e.argumento)),tipo_argumentacion:null===e||void 0===e||null===(u=e.prelecture)||void 0===u||null===(x=u.argumentation)||void 0===x?void 0:x.tipo_argumentacion,terminos_tecnicos:null===e||void 0===e||null===(f=e.prelecture)||void 0===f||null===(y=f.linguistics)||void 0===y||null===(b=y.lexico_especializado)||void 0===b?void 0:b.terminos_tecnicos,conceptos_clave:null===e||void 0===e||null===(v=e.critical)||void 0===v?void 0:v.temas_principales,resumen_previo:null===e||void 0===e||null===(j=e.critical)||void 0===j?void 0:j.resumen,figuras_retoricas:null===e||void 0===e||null===(S=e.prelecture)||void 0===S||null===(C=S.linguistics)||void 0===C||null===($=C.figuras_retoricas)||void 0===$?void 0:$.map((e=>"string"===typeof e?e:e.tipo)),marcos_ideologicos:null===e||void 0===e||null===(w=e.critical)||void 0===w||null===(E=w.contexto_critico)||void 0===E?void 0:E.marcos_ideologicos,voces_representadas:null===e||void 0===e||null===(T=e.critical)||void 0===T||null===(A=T.contexto_critico)||void 0===A?void 0:A.voces_representadas};return Object.fromEntries(Object.entries(_).filter((e=>{let[t,o]=e;return null!=o&&void 0!==o})))}),[]),I=(0,r.useCallback)((async function(e,t){var o,r;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)throw new Error("No hay texto para analizar");const n=k(a),s=(null===n||void 0===n?void 0:n.genero)||t;console.log("[useNotasEstudio] Generando notas con contexto enriquecido:",{genero:null===n||void 0===n?void 0:n.genero,tiene_tesis:!(null===n||void 0===n||!n.tesis_central),tiene_conceptos:!(null===n||void 0===n||!n.conceptos_clave),tiene_resumen:!(null===n||void 0===n||!n.resumen_previo)});try{const t={texto:e,api:"openai",contexto:n,nivelAcademico:u},o=await(0,i.u9)("https://applectura-backend.onrender.com/api/notes/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},45e3);if(o.ok){const e=await o.json();return console.log("[useNotasEstudio] Notas generadas con contexto del backend"),e}{const e=await o.text();throw new Error(e||`HTTP ${o.status}`)}}catch(c){console.warn("[useNotasEstudio] Backend no disponible, usando OpenAI directo:",null===c||void 0===c?void 0:c.message)}try{let o=s;return null!==n&&void 0!==n&&n.genero||"auto"!==t?null!==n&&void 0!==n&&n.genero&&console.log(`[useNotasEstudio] Usando tipo del an\xe1lisis: ${o}`):(o=await d.OpenAI.detectarTipoTexto(e),console.log(`[useNotasEstudio] Tipo detectado autom\xe1ticamente: ${o}`)),await d.OpenAI.generarNotasSegunTipo(e,o)}catch(m){console.warn("[useNotasEstudio] OpenAI directo fall\xf3, usando fallback local:",null===m||void 0===m?void 0:m.message)}console.log("[useNotasEstudio] Usando fallback local con contexto del an\xe1lisis");const l=e.split(/[.!?]/).filter(Boolean).slice(0,3).map((e=>e.trim()));return{resumen:(null===n||void 0===n?void 0:n.resumen_previo)||e.slice(0,400)+(e.length>400?"...":""),notas:[...null!==n&&void 0!==n&&n.tesis_central?[{titulo:"Tesis Central",contenido:n.tesis_central}]:[],...(null===n||void 0===n||null===(o=n.argumentos_principales)||void 0===o?void 0:o.slice(0,3).map(((e,t)=>({titulo:`Argumento ${t+1}`,contenido:e}))))||l.map(((e,t)=>({titulo:`Nota ${t+1}`,contenido:e})))],preguntas:["\xbfCu\xe1l es la idea principal del texto?",...null!==n&&void 0!==n&&n.tesis_central?[`\xbfC\xf3mo se relaciona la tesis "${n.tesis_central.slice(0,50)}..." con los argumentos?`]:[],"\xbfQu\xe9 conceptos clave recuerdas?","\xbfC\xf3mo aplicar\xedas este contenido?"],tarjetas:[...(null===n||void 0===n||null===(r=n.conceptos_clave)||void 0===r?void 0:r.slice(0,3).map((e=>({frente:e,reverso:"Concepto clave identificado en el an\xe1lisis del texto"}))))||[],...l.slice(0,2).map(((e,t)=>({frente:`Concepto ${t+1}`,reverso:e})))].slice(0,5)}}),[k,u]),R=(0,r.useCallback)((async function(){if(e&&(!o||arguments.length>0&&void 0!==arguments[0]&&arguments[0])){y(!0),v("");try{const o=await I(e,m,t);a(o);const r=_(p);s(r),c({}),A(o,r),console.log("[useNotasEstudio] Notas inicializadas exitosamente")}catch(r){const e=`No se pudieron generar las notas de estudio: ${r.message}`;v(e),console.error("[useNotasEstudio] Error en inicializaci\xf3n:",r)}finally{y(!1)}}}),[e,m,p,o,t,I,_,A]),z=(0,r.useCallback)((async()=>{console.log("[useNotasEstudio] Regenerando notas..."),await R(!0)}),[R]),B=(0,r.useCallback)((e=>{try{const t=[...n];d.Cronograma.marcarRepasoCompletado(t,e),s(t);const r={...l,[e]:!0};c(r),A(o,t);const a=d.Storage.cargarEstadisticas();d.Storage.guardarEstadisticas({...a,repasosCompletados:(a.repasosCompletados||0)+1}),console.log(`[useNotasEstudio] Repaso ${e+1} marcado como completado`)}catch(b){console.error("[useNotasEstudio] Error al marcar repaso completado:",b),v("No se pudo marcar el repaso como completado")}}),[n,l,o,A]),D=(0,r.useCallback)((e=>{try{const t={tipoTexto:m,duracionEstudio:p,...e};d.Storage.guardarConfiguracion(t),console.log("[useNotasEstudio] Configuraci\xf3n actualizada")}catch(b){console.error("[useNotasEstudio] Error al actualizar configuraci\xf3n:",b)}}),[m,p]),N=(0,r.useMemo)((()=>n.length?d.Cronograma.calcularEstadisticasProgreso(n):{total:0,completados:0,pendientes:0,porcentajeCompletado:0}),[n]);return(0,r.useEffect)((()=>{j||(E(),S(!0))}),[j,E]),(0,r.useEffect)((()=>{if(!e||!j)return;const t=w(e);t!==C&&($(t),a(null),s([]),c({}),v(""),T(e))}),[e,j,C,w,T]),(0,r.useEffect)((()=>{j&&D({})}),[m,p,j,D]),{notas:o,cronograma:n,notasRepasadas:l,tipoTexto:m,duracionEstudio:p,nivelAcademico:u,cargando:f,error:b,estadisticasProgreso:N,setTipoTexto:g,setDuracionEstudio:h,setNivelAcademico:x,regenerarNotas:z,marcarRepasoCompletado:B,limpiarError:()=>v(""),reinicializarNotas:()=>R(!0),tieneNotas:Boolean(o),tieneCronograma:n.length>0,textoActivo:Boolean(e)}},m={xs:"4px",sm:"8px",md:"16px",lg:"24px",xl:"32px",xxl:"48px",compact:"8px",element:"12px",subsection:"20px",section:"28px"},g={xs:"0.64rem",sm:"0.8rem",base:"1rem",md:"1.125rem",lg:"1.25rem",xl:"1.563rem","2xl":"1.953rem","3xl":"2.441rem","4xl":"3.052rem"},p={light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800},h={tight:1.2,snug:1.375,normal:1.5,relaxed:1.7,loose:2},u={tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},x={none:"0",sm:"4px",md:"8px",lg:"12px",xl:"16px","2xl":"20px",full:"9999px"},f={none:"0",thin:"1px",normal:"2px",thick:"4px",heavy:"8px"},y={none:"none",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",inner:"inset 0 2px 4px 0 rgba(0, 0, 0, 0.05)"},b={fastest:"75ms",fast:"150ms",normal:"250ms",slow:"400ms",slower:"600ms",slowest:"1000ms"},v={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",bounce:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",smooth:"cubic-bezier(0.4, 0, 0.2, 1)",spring:"cubic-bezier(0.175, 0.885, 0.32, 1.275)"},j={fastest:`${b.fastest} ${v.ease}`,fast:`${b.fast} ${v.ease}`,normal:`${b.normal} ${v.ease}`,slow:`${b.slow} ${v.ease}`,color:`color ${b.fast} ${v.ease}`,background:`background-color ${b.normal} ${v.ease}`,transform:`transform ${b.normal} ${v.smooth}`,all:`all ${b.normal} ${v.ease}`},S={sm:"640px",md:"768px",lg:"900px",xl:"1024px",full:"100%"},C={disabled:.4,inactive:.6,subtle:.7,hover:.8,active:1},$={button:{borderRadius:x.md,minHeight:"44px",paddingSm:`${m.sm} ${m.md}`,paddingMd:`${m.md} ${m.lg}`,paddingLg:`${m.lg} ${m.xl}`,transition:j.normal},card:{borderRadius:x.lg,padding:m.lg,shadow:y.md},input:{borderRadius:x.md,padding:`${m.sm} ${m.md}`,borderWidth:f.thin,minHeight:"44px"},badge:{borderRadius:x.full,padding:`${m.xs} ${m.sm}`,fontSize:g.xs,fontWeight:p.semibold}};var w=o(4414);const E=r.memo((e=>{let{theme:t,size:o="md"}=e;const r={sm:"24px",md:"40px",lg:"60px"};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{role:"status","aria-live":"polite","aria-label":"Cargando contenido",style:{width:r[o],height:r[o],border:`4px solid ${t.border}`,borderTopColor:t.primary,borderRadius:x.full,animation:"spin 0.8s linear infinite",margin:"0 auto"}}),(0,w.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n\n        @media (prefers-reduced-motion: reduce) {\n          @keyframes spin {\n            0% { opacity: 0.5; }\n            50% { opacity: 1; }\n            100% { opacity: 0.5; }\n          }\n        }\n      "})]})})),T=r.memo((e=>{let{theme:t,size:o="md"}=e;const r={sm:"24px",md:"40px",lg:"60px"};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{role:"status","aria-live":"polite","aria-label":"Procesando",style:{position:"relative",width:r[o],height:r[o],margin:"0 auto"},children:[(0,w.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundColor:t.primary,borderRadius:x.full,animation:"pulse 1.4s ease-in-out infinite",opacity:.6}}),(0,w.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundColor:t.secondary,borderRadius:x.full,animation:"pulse 1.4s ease-in-out 0.7s infinite",opacity:.6}})]}),(0,w.jsx)("style",{children:"\n        @keyframes pulse {\n          0% {\n            transform: scale(0.5);\n            opacity: 0.8;\n          }\n          50% {\n            transform: scale(1);\n            opacity: 0.4;\n          }\n          100% {\n            transform: scale(0.5);\n            opacity: 0.8;\n          }\n        }\n\n        @media (prefers-reduced-motion: reduce) {\n          @keyframes pulse {\n            0%, 100% { opacity: 0.5; }\n            50% { opacity: 1; }\n          }\n        }\n      "})]})})),A=r.memo((e=>{let{theme:t}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{role:"status","aria-live":"polite","aria-label":"Cargando",style:{display:"flex",gap:m.sm,justifyContent:"center",alignItems:"center"},children:[(0,w.jsx)("div",{style:{width:"12px",height:"12px",backgroundColor:t.primary,borderRadius:x.full,animation:"bounce 1.4s ease-in-out infinite"}}),(0,w.jsx)("div",{style:{width:"12px",height:"12px",backgroundColor:t.secondary,borderRadius:x.full,animation:"bounce 1.4s ease-in-out 0.2s infinite"}}),(0,w.jsx)("div",{style:{width:"12px",height:"12px",backgroundColor:t.accent,borderRadius:x.full,animation:"bounce 1.4s ease-in-out 0.4s infinite"}})]}),(0,w.jsx)("style",{children:"\n        @keyframes bounce {\n          0%, 80%, 100% {\n            transform: scale(0.8);\n            opacity: 0.5;\n          }\n          40% {\n            transform: scale(1.2);\n            opacity: 1;\n          }\n        }\n\n        @media (prefers-reduced-motion: reduce) {\n          @keyframes bounce {\n            0%, 100% { opacity: 0.5; }\n            50% { opacity: 1; }\n          }\n        }\n      "})]})})),_=r.memo((e=>{let{theme:t,width:o="100%",height:r="20px",style:a={}}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{role:"status","aria-live":"polite","aria-label":"Cargando contenido",style:{width:o,height:r,backgroundColor:t.border,borderRadius:x.md,animation:"shimmer 1.5s ease-in-out infinite",backgroundImage:`linear-gradient(90deg, ${t.border} 0%, ${t.cardBg} 50%, ${t.border} 100%)`,backgroundSize:"200% 100%",...a}}),(0,w.jsx)("style",{children:"\n        @keyframes shimmer {\n          0% {\n            background-position: -200% 0;\n          }\n          100% {\n            background-position: 200% 0;\n          }\n        }\n\n        @media (prefers-reduced-motion: reduce) {\n          @keyframes shimmer {\n            0%, 100% { opacity: 0.5; }\n            50% { opacity: 1; }\n          }\n        }\n      "})]})})),k=r.memo((e=>{let{theme:t}=e;return(0,w.jsxs)("div",{style:{backgroundColor:t.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${t.border}`,marginBottom:m.md},children:[(0,w.jsx)(_,{theme:t,width:"60%",height:"24px",style:{marginBottom:m.md}}),(0,w.jsx)(_,{theme:t,width:"100%",height:"16px",style:{marginBottom:m.sm}}),(0,w.jsx)(_,{theme:t,width:"90%",height:"16px",style:{marginBottom:m.sm}}),(0,w.jsx)(_,{theme:t,width:"85%",height:"16px"})]})})),I=r.memo((e=>{let{theme:t,variant:o="spinner",size:r="md",title:a="Cargando...",description:i=null,steps:n=null,showSkeleton:s=!1}=e;return s?(0,w.jsxs)("div",{style:{padding:m.xl},children:[(0,w.jsx)(k,{theme:t}),(0,w.jsx)(k,{theme:t}),(0,w.jsx)(k,{theme:t})]}):(0,w.jsxs)("div",{style:{textAlign:"center",padding:`${m.xxl} ${m.lg}`,color:t.text},children:[(0,w.jsxs)("div",{style:{marginBottom:m.lg},children:["spinner"===o&&(0,w.jsx)(E,{theme:t,size:r}),"pulse"===o&&(0,w.jsx)(T,{theme:t,size:r}),"dots"===o&&(0,w.jsx)(A,{theme:t})]}),a&&(0,w.jsx)("h3",{style:{color:t.text,fontSize:g.lg,fontWeight:p.semibold,margin:`0 0 ${m.sm} 0`},children:a}),i&&(0,w.jsx)("p",{style:{color:t.lightText,fontSize:g.base,lineHeight:h.relaxed,margin:`0 0 ${m.lg} 0`,maxWidth:"500px",marginLeft:"auto",marginRight:"auto"},children:i}),n&&Array.isArray(n)&&n.length>0&&(0,w.jsx)("div",{style:{marginTop:m.lg,textAlign:"left",maxWidth:"400px",marginLeft:"auto",marginRight:"auto",backgroundColor:t.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${t.border}`},children:n.map(((e,o)=>(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.sm,marginBottom:o<n.length-1?m.md:0,color:e.completed?t.primary:t.lightText,fontSize:g.sm},children:[(0,w.jsx)("div",{style:{width:"20px",height:"20px",borderRadius:x.full,backgroundColor:e.completed?t.primary:"transparent",border:`2px solid ${e.completed?t.primary:t.border}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:j.normal},children:e.completed&&(0,w.jsx)("span",{style:{color:"#fff",fontSize:"12px"},children:"\u2713"})}),(0,w.jsx)("span",{style:{fontWeight:e.completed?p.semibold:p.normal},children:e.label})]},o)))})]})})),R=r.memo((e=>{let{error:t,onRetry:o,theme:r,modoOscuro:a}=e;return(0,w.jsxs)("div",{style:{color:r.error,padding:m.lg,backgroundColor:a?"rgba(244, 67, 54, 0.1)":"#ffebee",borderRadius:x.lg,marginBottom:m.xl,border:`${f.normal} solid ${r.error}`},children:[(0,w.jsx)("p",{style:{margin:`0 0 ${m.sm} 0`,fontWeight:p.bold,fontSize:g.lg,display:"flex",alignItems:"center",gap:m.xs},children:"\u26a0\ufe0f Error"}),(0,w.jsx)("p",{style:{margin:0,lineHeight:h.relaxed,fontSize:g.base},children:t}),(0,w.jsx)("button",{onClick:o,style:{backgroundColor:r.error,color:"#fff",border:"none",borderRadius:x.md,padding:`${m.sm} ${m.md}`,cursor:"pointer",marginTop:m.lg,fontSize:g.base,fontWeight:p.semibold,minHeight:$.button.minHeight,transition:j.all,boxShadow:y.sm},onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow=y.md},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow=y.sm},children:"\ud83d\udd04 Intentar nuevamente"})]})})),z=r.memo((e=>{let{theme:t,title:o,description:r,variant:a="pulse"}=e;return(0,w.jsx)(I,{theme:t,variant:a,size:"lg",title:o||"Generando notas de estudio...",description:r||"Analizando el texto y creando notas personalizadas para tu nivel acad\xe9mico",steps:[{label:"Analizando estructura del texto",completed:!0},{label:"Identificando conceptos clave",completed:!0},{label:"Generando notas personalizadas",completed:!1},{label:"Creando cronograma de repaso",completed:!1}]})})),B=r.memo((e=>{let{concepto:t,theme:o}=e;return(0,w.jsx)("span",{style:{backgroundColor:o.accent,color:"#fff",padding:`${m.xs} ${m.sm}`,borderRadius:x.full,fontSize:g.sm,fontWeight:p.medium,display:"inline-block",transition:j.normal,cursor:"default"},onMouseOver:e=>{e.target.style.transform="scale(1.05)",e.target.style.boxShadow=y.sm},onMouseOut:e=>{e.target.style.transform="scale(1)",e.target.style.boxShadow="none"},children:t})})),D=r.memo((e=>{let{theme:t}=e;return(0,w.jsxs)("div",{style:{marginTop:m.xl,padding:m.lg,backgroundColor:t.cardBg,borderRadius:x.lg,border:`${f.normal} solid ${t.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h3",{style:{color:t.text,marginTop:0,marginBottom:m.md,fontSize:g.lg,fontWeight:p.semibold,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udca1 \xbfQu\xe9 es el Aprendizaje Espaciado?"}),(0,w.jsx)("p",{style:{color:t.text,lineHeight:h.relaxed,margin:0,fontSize:g.base},children:"El aprendizaje espaciado es una t\xe9cnica de estudio que consiste en revisar el material en intervalos crecientes de tiempo, aprovechando la curva del olvido para mejorar la retenci\xf3n a largo plazo."}),(0,w.jsx)("p",{style:{color:t.text},children:"Sigue el cronograma de repaso para maximizar tu retenci\xf3n del material. Cada repaso refuerza la memoria y hace que sea m\xe1s dif\xedcil olvidar lo aprendido."})]})})),N=r.memo((e=>{let{theme:t,tipoTexto:o,setTipoTexto:r,duracionEstudio:a,setDuracionEstudio:i,regenerarNotas:n,nivelAcademico:s,setNivelAcademico:l}=e;return(0,w.jsxs)("div",{style:{backgroundColor:t.cardBg,borderRadius:x.lg,padding:m.lg,marginTop:m.md,marginBottom:m.lg,border:`${f.thin} solid ${t.border}`,boxShadow:y.md},id:"panel-configuracion",children:[(0,w.jsx)("h3",{style:{color:t.text,marginTop:0,marginBottom:m.lg,fontSize:g.xl,fontWeight:p.semibold,display:"flex",alignItems:"center",gap:m.sm},children:"\u2699\ufe0f Configuraci\xf3n de Notas"}),(0,w.jsxs)("div",{style:{marginBottom:m.lg,padding:m.md,backgroundColor:t.background,borderRadius:x.md,border:`${f.thin} solid ${t.border}`},children:[(0,w.jsx)("label",{htmlFor:"tipo-texto",style:{display:"flex",alignItems:"center",gap:m.xs,marginBottom:m.sm,color:t.text,fontWeight:p.semibold,fontSize:g.base},children:"\ud83d\udcc4 Tipo de texto"}),(0,w.jsxs)("select",{id:"tipo-texto",value:o,onChange:e=>r(e.target.value),style:{width:"100%",padding:`${m.sm} ${m.md}`,borderRadius:x.md,border:`${f.thin} solid ${t.border}`,backgroundColor:t.background,color:t.text,fontSize:g.base,cursor:"pointer",minHeight:$.input.minHeight,transition:j.normal},children:[(0,w.jsx)("option",{value:"auto",children:"Detecci\xf3n autom\xe1tica"}),(0,w.jsx)("option",{value:"narrativo",children:"Narrativo"}),(0,w.jsx)("option",{value:"poetico",children:"Po\xe9tico"}),(0,w.jsx)("option",{value:"filosofico",children:"Filos\xf3fico"}),(0,w.jsx)("option",{value:"ensayo",children:"Ensayo"})]}),(0,w.jsx)("p",{style:{color:t.lightText,fontSize:g.sm,margin:`${m.sm} 0 0 0`,lineHeight:h.normal},children:"Selecciona el tipo o deja que la IA lo detecte autom\xe1ticamente"})]}),void 0!==s&&l&&(0,w.jsxs)("div",{style:{marginBottom:m.lg,padding:m.md,backgroundColor:t.background,borderRadius:x.md,border:`${f.thin} solid ${t.border}`},children:[(0,w.jsx)("label",{htmlFor:"nivel-academico",style:{display:"flex",alignItems:"center",gap:m.xs,marginBottom:m.sm,color:t.text,fontWeight:p.semibold,fontSize:g.base},children:"\ud83d\udcda Nivel acad\xe9mico"}),(0,w.jsxs)("select",{id:"nivel-academico",value:s,onChange:e=>l(e.target.value),style:{width:"100%",padding:`${m.sm} ${m.md}`,borderRadius:x.md,border:`${f.thin} solid ${t.border}`,backgroundColor:t.background,color:t.text,fontSize:g.base,cursor:"pointer",minHeight:$.input.minHeight,transition:j.normal},children:[(0,w.jsx)("option",{value:"secundaria",children:"Secundaria (b\xe1sico)"}),(0,w.jsx)("option",{value:"pregrado",children:"Pregrado / Licenciatura (intermedio)"}),(0,w.jsx)("option",{value:"posgrado",children:"Posgrado / Maestr\xeda (avanzado)"}),(0,w.jsx)("option",{value:"doctorado",children:"Doctorado / Investigaci\xf3n (experto)"})]}),(0,w.jsx)("p",{style:{color:t.lightText,fontSize:g.sm,margin:`${m.sm} 0 0 0`,lineHeight:h.normal},children:"Las notas se adaptar\xe1n al nivel de complejidad seleccionado"})]}),(0,w.jsxs)("div",{style:{marginBottom:m.lg,padding:m.md,backgroundColor:t.background,borderRadius:x.md,border:`${f.thin} solid ${t.border}`},children:[(0,w.jsxs)("label",{htmlFor:"duracion-estudio",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:m.md,color:t.text,fontWeight:p.semibold,fontSize:g.base},children:[(0,w.jsx)("span",{style:{display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udcc5 Duraci\xf3n del estudio"}),(0,w.jsxs)("span",{style:{color:t.primary,fontWeight:p.bold,fontSize:g.lg},children:[a," d\xedas"]})]}),(0,w.jsx)("input",{id:"duracion-estudio",type:"range",min:"7",max:"90",value:a,onChange:e=>i(parseInt(e.target.value)),style:{width:"100%",cursor:"pointer",marginBottom:m.sm}}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",color:t.lightText,fontSize:g.sm},children:[(0,w.jsx)("span",{children:"7 d\xedas (m\xednimo)"}),(0,w.jsx)("span",{children:"30 d\xedas (recomendado)"}),(0,w.jsx)("span",{children:"90 d\xedas (m\xe1ximo)"})]})]}),(0,w.jsx)("button",{onClick:n,style:{backgroundColor:t.secondary,color:"#fff",border:"none",borderRadius:x.md,padding:`${m.md} ${m.lg}`,cursor:"pointer",width:"100%",fontWeight:p.bold,fontSize:g.base,minHeight:$.button.minHeight,transition:j.all,boxShadow:y.sm},onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow=y.md},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow=y.sm},children:"\ud83d\udd04 Regenerar notas con esta configuraci\xf3n"})]})})),O=r.memo((e=>{let{notas:t,theme:o}=e;return(0,w.jsxs)("div",{style:{marginTop:m.xl},children:[(0,w.jsx)("h3",{style:{color:o.text,fontSize:g.xl,fontWeight:p.bold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.sm},children:"\ud83d\udcd6 Notas de Estudio - Texto Narrativo"}),(0,w.jsx)("h4",{style:{color:o.text,fontSize:g.lg,fontWeight:p.semibold,marginBottom:m.lg,paddingBottom:m.sm,borderBottom:`${f.thin} solid ${o.border}`},children:t.titulo}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udc65 Personajes"}),(0,w.jsx)("ul",{style:{color:o.text,lineHeight:h.relaxed,margin:0,paddingLeft:m.lg},children:t.personajes&&t.personajes.map(((e,t)=>(0,w.jsxs)("li",{style:{marginBottom:m.sm},children:[(0,w.jsxs)("strong",{style:{color:o.primary},children:[e.nombre,":"]})," ",e.descripcion]},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udf0d Espacio y Tiempo"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0},children:t.espacioTiempo})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udde3\ufe0f Voz Narrativa"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0},children:t.vozNarrativa})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udfaf Temas"}),(0,w.jsx)("ul",{style:{color:o.text,lineHeight:h.relaxed,margin:0,paddingLeft:m.lg},children:t.temas&&t.temas.map(((e,t)=>(0,w.jsx)("li",{style:{marginBottom:m.sm},children:e},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udcca Estructura"}),t.estructura&&(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:m.md},children:[(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,padding:m.sm,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.primary}`},children:[(0,w.jsx)("strong",{style:{color:o.primary},children:"Inicio:"})," ",t.estructura.inicio]}),(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,padding:m.sm,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.secondary}`},children:[(0,w.jsx)("strong",{style:{color:o.secondary},children:"Desarrollo:"})," ",t.estructura.desarrollo]}),(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,padding:m.sm,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.accent}`},children:[(0,w.jsx)("strong",{style:{color:o.accent},children:"Desenlace:"})," ",t.estructura.desenlace]})]})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udd2e S\xedmbolos"}),(0,w.jsx)("ul",{style:{color:o.text,lineHeight:h.relaxed,margin:0,paddingLeft:m.lg},children:t.simbolos&&t.simbolos.map(((e,t)=>(0,w.jsxs)("li",{style:{marginBottom:m.sm},children:[(0,w.jsxs)("strong",{style:{color:o.primary},children:[e.simbolo,":"]})," ",e.significado]},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udd11 Conceptos Clave"}),(0,w.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:m.sm},children:t.conceptosClave&&t.conceptosClave.map(((e,t)=>(0,w.jsx)(B,{concepto:e,theme:o},t)))})]})]})})),P=r.memo((e=>{let{notas:t,theme:o}=e;return(0,w.jsxs)("div",{style:{marginTop:m.xl},children:[(0,w.jsx)("h3",{style:{color:o.text,fontSize:g.xl,fontWeight:p.bold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.sm},children:"\u2728 Notas de Estudio - Texto Po\xe9tico"}),(0,w.jsx)("h4",{style:{color:o.text,fontSize:g.lg,fontWeight:p.semibold,marginBottom:m.lg,paddingBottom:m.sm,borderBottom:`${f.thin} solid ${o.border}`},children:t.titulo}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udfad Objeto Po\xe9tico"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,fontStyle:"italic",padding:m.md,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.primary}`},children:t.objetoPoetico})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udfa8 Recursos Literarios"}),(0,w.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:m.md},children:t.recursosLiterarios&&t.recursosLiterarios.map(((e,t)=>(0,w.jsxs)("div",{style:{padding:m.md,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.secondary}`},children:[(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0},children:[(0,w.jsxs)("strong",{style:{color:o.secondary},children:[e.recurso,":"]})," ",e.ejemplo]}),e.efecto&&(0,w.jsxs)("p",{style:{color:o.lightText,fontSize:g.sm,fontStyle:"italic",margin:`${m.xs} 0 0 0`},children:["\u2192 ",e.efecto]})]},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udccf M\xe9trica y Rima"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0},children:t.metricaRima})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udfb5 Tono y Atm\xf3sfera"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0},children:t.tonoAtmosfera})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udcad Interpretaci\xf3n"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,padding:m.md,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.accent}`},children:t.interpretacion})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udd11 Conceptos Clave"}),(0,w.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:m.sm},children:t.conceptosClave&&t.conceptosClave.map(((e,t)=>(0,w.jsx)(B,{concepto:e,theme:o},t)))})]})]})})),W=r.memo((e=>{let{notas:t,theme:o}=e;return(0,w.jsxs)("div",{style:{marginTop:m.xl},children:[(0,w.jsx)("h3",{style:{color:o.text,fontSize:g.xl,fontWeight:p.bold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.sm},children:"\ud83e\udde0 Notas de Estudio - Texto Filos\xf3fico"}),(0,w.jsx)("h4",{style:{color:o.text,fontSize:g.lg,fontWeight:p.semibold,marginBottom:m.lg,paddingBottom:m.sm,borderBottom:`${f.thin} solid ${o.border}`},children:t.titulo}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udca1 Ideas Fundamentales"}),(0,w.jsx)("ul",{style:{color:o.text,lineHeight:h.relaxed,margin:0,paddingLeft:m.lg},children:t.ideasFundamentales&&t.ideasFundamentales.map(((e,t)=>(0,w.jsx)("li",{style:{marginBottom:m.sm,padding:m.sm,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.primary}`},children:e},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\u2753 Preguntas Clave"}),(0,w.jsx)("ul",{style:{color:o.text,lineHeight:h.relaxed,margin:0,paddingLeft:m.lg},children:t.preguntasClave&&t.preguntasClave.map(((e,t)=>(0,w.jsx)("li",{style:{marginBottom:m.sm,fontStyle:"italic"},children:e},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udfaf Argumentos"}),(0,w.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:m.md},children:t.argumentos&&t.argumentos.map(((e,t)=>(0,w.jsxs)("div",{style:{padding:m.md,backgroundColor:o.background,borderRadius:x.md,border:`${f.normal} solid ${o.border}`},children:[(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:`0 0 ${m.sm} 0`},children:[(0,w.jsx)("strong",{style:{color:o.secondary},children:"Premisa:"})," ",e.premisa]}),(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,paddingTop:m.sm,borderTop:`${f.thin} solid ${o.border}`},children:[(0,w.jsx)("strong",{style:{color:o.primary},children:"Conclusi\xf3n:"})," ",e.conclusion]})]},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83c\udfdb\ufe0f Corriente Filos\xf3fica"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0,padding:m.md,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.accent}`},children:t.corrienteFilosofica})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udcda Conceptos Esenciales"}),(0,w.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:m.sm},children:t.conceptosEsenciales&&t.conceptosEsenciales.map(((e,t)=>(0,w.jsx)("div",{style:{padding:m.sm,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.secondary}`},children:(0,w.jsxs)("p",{style:{color:o.text,lineHeight:h.relaxed,margin:0},children:[(0,w.jsxs)("strong",{style:{color:o.secondary},children:[e.concepto,":"]})," ",e.definicion]})},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:m.lg,backgroundColor:o.cardBg,padding:m.lg,borderRadius:x.lg,border:`${f.normal} solid ${o.border}`,boxShadow:y.sm},children:[(0,w.jsx)("h5",{style:{color:o.primary,fontSize:g.md,fontWeight:p.semibold,marginBottom:m.md,display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udd11 Conceptos Clave"}),(0,w.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:m.sm},children:t.conceptosClave&&t.conceptosClave.map(((e,t)=>(0,w.jsx)(B,{concepto:e,theme:o},t)))})]})]})})),H=r.memo((e=>{let{notas:t,theme:o}=e;return(0,w.jsxs)("div",{style:{marginTop:"20px"},children:[(0,w.jsx)("h3",{style:{color:o.text},children:"Notas de Estudio - Ensayo"}),(0,w.jsx)("h4",{style:{color:o.text},children:t.titulo}),(0,w.jsxs)("div",{style:{marginTop:"15px"},children:[(0,w.jsx)("h5",{style:{color:o.primary},children:"Tesis Principal"}),(0,w.jsx)("p",{style:{color:o.text},children:t.tesisPrincipal})]}),(0,w.jsxs)("div",{style:{marginTop:"15px"},children:[(0,w.jsx)("h5",{style:{color:o.primary},children:"Ideas Secundarias"}),(0,w.jsx)("ul",{style:{color:o.text},children:t.ideasSecundarias&&t.ideasSecundarias.map(((e,t)=>(0,w.jsx)("li",{children:e},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:"15px"},children:[(0,w.jsx)("h5",{style:{color:o.primary},children:"Evidencia"}),(0,w.jsx)("ul",{style:{color:o.text},children:t.evidencia&&t.evidencia.map(((e,t)=>(0,w.jsxs)("li",{children:[(0,w.jsxs)("strong",{children:[e.tipo,":"]})," ",e.descripcion]},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:"15px"},children:[(0,w.jsx)("h5",{style:{color:o.primary},children:"Estructura L\xf3gica"}),(0,w.jsx)("ol",{style:{color:o.text},children:t.estructuraLogica&&t.estructuraLogica.map(((e,t)=>(0,w.jsx)("li",{children:e},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:"15px"},children:[(0,w.jsx)("h5",{style:{color:o.primary},children:"Conclusiones"}),(0,w.jsx)("ul",{style:{color:o.text},children:t.conclusiones&&t.conclusiones.map(((e,t)=>(0,w.jsx)("li",{children:e},t)))})]}),(0,w.jsxs)("div",{style:{marginTop:"15px"},children:[(0,w.jsx)("h5",{style:{color:o.primary},children:"Conceptos Clave"}),(0,w.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:t.conceptosClave&&t.conceptosClave.map(((e,t)=>(0,w.jsx)(B,{concepto:e,theme:o},t)))})]})]})})),M=r.memo((e=>{let{data:t,theme:o}=e;const a=e=>{let{card:t,idx:a}=e;const[i,n]=r.useState(!1),[s,l]=r.useState(!1);return(0,w.jsxs)("div",{style:{backgroundColor:o.cardBg,border:`${f.normal} solid ${o.border}`,borderRadius:x.lg,padding:m.lg,width:"undefined"!==typeof window&&window.innerWidth<600?"100%":"calc(50% - 8px)",minHeight:"180px",display:"flex",flexDirection:"column",justifyContent:"space-between",transition:j.all,transform:s?"scale(0.98)":"scale(1)",boxShadow:y.md},onMouseOver:e=>{s||(e.currentTarget.style.boxShadow=y.lg,e.currentTarget.style.transform="translateY(-4px)")},onMouseOut:e=>{s||(e.currentTarget.style.boxShadow=y.md,e.currentTarget.style.transform="translateY(0)")},children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{style:{color:o.text,fontWeight:p.semibold,marginBottom:m.md,fontSize:g.base,lineHeight:h.normal},children:t.frente}),i&&(0,w.jsx)("div",{style:{color:o.text,marginTop:m.md,padding:m.md,backgroundColor:o.background,borderRadius:x.md,fontSize:g.sm,lineHeight:h.relaxed,animation:"fadeIn 0.3s ease",borderLeft:`${f.thick} solid ${o.primary}`},children:t.reverso})]}),(0,w.jsxs)("button",{onClick:()=>{l(!0),setTimeout((()=>{n((e=>!e)),l(!1)}),150)},style:{backgroundColor:i?o.primary:o.secondary,color:"#fff",border:"none",borderRadius:x.md,padding:`${m.md} ${m.lg}`,cursor:"pointer",fontSize:g.base,fontWeight:p.bold,marginTop:m.md,transition:j.all,minHeight:$.button.minHeight,boxShadow:y.sm,width:"100%"},onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow=y.md},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow=y.sm},children:[i?"\ud83d\udd12 Ocultar":"\ud83d\udd13 Mostrar"," respuesta"]}),(0,w.jsx)("style",{children:"\n          @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(-10px); }\n            to { opacity: 1; transform: translateY(0); }\n          }\n\n          @media (prefers-reduced-motion: reduce) {\n            @keyframes fadeIn {\n              from, to { \n                opacity: 1; \n                transform: translateY(0); \n              }\n            }\n          }\n        "})]})};return(0,w.jsxs)("div",{style:{marginTop:m.lg},children:[t.resumen&&(0,w.jsxs)("div",{style:{marginBottom:m.lg},children:[(0,w.jsx)("h3",{style:{color:o.text,margin:`0 0 ${m.md} 0`,fontSize:g.xl,fontWeight:p.semibold,borderBottom:`${f.normal} solid ${o.border}`,paddingBottom:m.sm},children:"\ud83d\udcdd Resumen"}),(0,w.jsx)("p",{style:{color:o.text,lineHeight:h.relaxed,fontSize:g.base},children:t.resumen})]}),Array.isArray(t.notas)&&t.notas.length>0&&(0,w.jsxs)("div",{style:{marginBottom:m.lg},children:[(0,w.jsx)("h3",{style:{color:o.text,margin:`0 0 ${m.md} 0`,fontSize:g.xl,fontWeight:p.semibold,borderBottom:`${f.normal} solid ${o.border}`,paddingBottom:m.sm},children:"\ud83d\udca1 Notas clave"}),(0,w.jsx)("ul",{style:{color:o.text,listStyle:"none",padding:0,margin:0},children:t.notas.map(((e,t)=>(0,w.jsxs)("li",{style:{padding:`${m.md} ${m.md}`,marginBottom:m.sm,backgroundColor:o.background,borderRadius:x.md,borderLeft:`${f.thick} solid ${o.primary}`,lineHeight:h.relaxed},children:[(0,w.jsxs)("strong",{style:{color:o.primary},children:[e.titulo,":"]})," ",e.contenido]},t)))})]}),Array.isArray(t.preguntas)&&t.preguntas.length>0&&(0,w.jsxs)("div",{style:{marginBottom:m.lg},children:[(0,w.jsx)("h3",{style:{color:o.text,margin:`0 0 ${m.md} 0`,fontSize:g.xl,fontWeight:p.semibold,borderBottom:`${f.normal} solid ${o.border}`,paddingBottom:m.sm},children:"\u2753 Preguntas de evocaci\xf3n"}),(0,w.jsx)("ol",{style:{color:o.text,paddingLeft:m.lg,margin:0},children:t.preguntas.map(((e,t)=>(0,w.jsx)("li",{style:{marginBottom:m.md,lineHeight:h.relaxed},children:e},t)))})]}),Array.isArray(t.tarjetas)&&t.tarjetas.length>0&&(0,w.jsxs)("div",{style:{marginBottom:m.lg},children:[(0,w.jsx)("h3",{style:{color:o.text,margin:`0 0 ${m.md} 0`,fontSize:g.xl,fontWeight:p.semibold,borderBottom:`${f.normal} solid ${o.border}`,paddingBottom:m.sm},children:"\ud83c\udfb4 Tarjetas (flashcards)"}),(0,w.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:m.md,marginTop:m.md},children:t.tarjetas.map(((e,t)=>(0,w.jsx)(a,{card:e,idx:t},t)))})]})]})})),F=r.memo((e=>{let{notas:t,theme:o}=e;if(!t)return(0,w.jsx)("div",{style:{textAlign:"center",padding:"40px 20px",color:o.lightText},children:(0,w.jsx)("p",{children:"No hay notas disponibles."})});if(t&&(t.resumen||Array.isArray(t.preguntas)&&t.preguntas.length))return(0,w.jsx)(M,{data:t,theme:o});switch(t.tipoTexto){case"narrativo":return(0,w.jsx)(O,{notas:t,theme:o});case"poetico":return(0,w.jsx)(P,{notas:t,theme:o});case"filosofico":return(0,w.jsx)(W,{notas:t,theme:o});case"ensayo":return(0,w.jsx)(H,{notas:t,theme:o});default:return(0,w.jsxs)("div",{style:{marginTop:"20px",padding:"20px",backgroundColor:o.cardBg,borderRadius:"8px",border:`1px solid ${o.border}`},children:[(0,w.jsx)("h3",{style:{color:o.text},children:"Notas de Estudio"}),(0,w.jsxs)("p",{style:{color:o.error},children:['Tipo de texto no reconocido: "',t.tipoTexto,'". Por favor, regenera las notas.']}),(0,w.jsx)("p",{style:{color:o.lightText,fontSize:"0.9em"},children:"Tipos soportados: narrativo, po\xe9tico, filos\xf3fico, ensayo"})]})}})),L=r.memo((e=>{let{repaso:t,index:o,esHoy:r,completado:a,theme:i,onMarcarCompletado:n}=e;return(0,w.jsxs)("div",{style:{backgroundColor:i.cardBg,borderRadius:x.lg,padding:m.lg,display:"flex",justifyContent:"space-between",alignItems:"center",border:`${f.normal} solid ${i.border}`,opacity:a?.8:1,position:"relative",overflow:"hidden",transition:j.all,transform:a?"scale(0.98)":"scale(1)",boxShadow:r&&!a?y.lg:y.sm},children:[a&&(0,w.jsx)("div",{style:{position:"absolute",top:"0",right:"0",backgroundColor:i.primary,color:"#fff",padding:`${m.xs} ${m.sm}`,fontSize:g.xs,borderBottomLeftRadius:x.md,fontWeight:p.bold,animation:"slideInRight 0.3s ease"},children:"\u2713 Completado"}),r&&!a&&(0,w.jsx)("div",{style:{position:"absolute",left:0,top:0,bottom:0,width:"4px",backgroundColor:i.accent,animation:"pulse 2s infinite"}}),(0,w.jsxs)("div",{style:{flex:1,paddingLeft:r&&!a?m.md:0},children:[(0,w.jsx)("h4",{style:{color:i.text,margin:`0 0 ${m.xs} 0`,textDecoration:a?"line-through":"none",fontSize:g.lg,fontWeight:p.semibold,transition:j.normal},children:t.descripcion}),(0,w.jsxs)("p",{style:{color:i.lightText,margin:"0",fontSize:g.sm,display:"flex",alignItems:"center",gap:m.sm,flexWrap:"wrap"},children:[0===t.dias?(0,w.jsx)("span",{style:{display:"flex",alignItems:"center",gap:m.xs},children:"\ud83d\udcc5 Hoy"}):(0,w.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:m.xs},children:["\ud83d\udcc5 D\xeda ",t.dias,": ",new Date(t.fecha).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})]}),r&&!a&&(0,w.jsx)("span",{style:{backgroundColor:i.accent,color:"#fff",padding:`${m.xs} ${m.sm}`,borderRadius:x.full,fontSize:g.xs,fontWeight:p.bold,animation:"pulse 2s infinite"},children:"\xa1Hoy!"})]}),!a&&t.dias>0&&(0,w.jsxs)("p",{style:{color:i.lightText,margin:`${m.xs} 0 0 0`,fontSize:g.xs,opacity:C.medium},children:[U(t.fecha)," d\xedas restantes"]})]}),(0,w.jsx)("button",{onClick:()=>n(o),disabled:a,"aria-label":a?"Repaso ya completado":"Marcar repaso como completado",style:{backgroundColor:a?i.border:i.primary,color:a?i.lightText:"#fff",border:"none",borderRadius:x.md,padding:`${m.sm} ${m.md}`,cursor:a?"default":"pointer",opacity:a?C.disabled:1,fontSize:g.sm,fontWeight:p.bold,transition:j.all,minWidth:"140px",minHeight:$.button.minHeight,boxShadow:a?"none":y.sm},onMouseOver:e=>{a||(e.target.style.backgroundColor=i.secondary,e.target.style.transform="translateY(-2px)",e.target.style.boxShadow=y.md)},onMouseOut:e=>{a||(e.target.style.backgroundColor=i.primary,e.target.style.transform="translateY(0)",e.target.style.boxShadow=y.sm)},children:a?"\u2713 Completado":"Marcar completado"}),(0,w.jsx)("style",{children:"\n      @keyframes pulse {\n        0%, 100% { opacity: 1; }\n        50% { opacity: 0.6; }\n      }\n      \n      @keyframes slideInRight {\n        from {\n          transform: translateX(100%);\n          opacity: 0;\n        }\n        to {\n          transform: translateX(0);\n          opacity: 1;\n        }\n      }\n\n      @media (prefers-reduced-motion: reduce) {\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.8; }\n        }\n        \n        @keyframes slideInRight {\n          from, to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n      }\n    "})]})})),U=e=>{const t=new Date,o=new Date(e),r=Math.ceil((o-t)/864e5);return Math.max(0,r)},K=r.memo((e=>{let{cronograma:t,notasRepasadas:o,theme:r}=e;const a=t.length,i=Object.keys(o).length,n=a>0?i/a*100:0;return(0,w.jsxs)("div",{style:{backgroundColor:r.cardBg,borderRadius:x.lg,padding:m.lg,border:`${f.normal} solid ${r.border}`,marginBottom:m.xl,boxShadow:y.md,position:"relative",overflow:"hidden"},children:[(0,w.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`linear-gradient(90deg, ${r.primary}15 ${n}%, transparent ${n}%)`,pointerEvents:"none",transition:"all 0.5s ease"}}),(0,w.jsxs)("div",{style:{position:"relative",zIndex:1},children:[(0,w.jsx)("h4",{style:{color:r.text,margin:`0 0 ${m.md} 0`,fontSize:g.lg,fontWeight:p.semibold,display:"flex",alignItems:"center",gap:m.sm},children:"\ud83d\udcca Progreso del Estudio"}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:m.md,flexWrap:"wrap",gap:m.sm},children:[(0,w.jsxs)("span",{style:{color:r.text,fontSize:g.base,fontWeight:p.medium},children:[i," de ",a," repasos completados"]}),(0,w.jsxs)("span",{style:{color:r.primary,fontWeight:p.bold,fontSize:g.xl,animation:100===n?"celebrate 0.5s ease":"none"},children:[n.toFixed(1),"%"]})]}),(0,w.jsx)("div",{style:{width:"100%",height:"12px",backgroundColor:r.border,borderRadius:x.full,overflow:"hidden",position:"relative",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.1)"},children:(0,w.jsx)("div",{style:{width:`${n}%`,height:"100%",background:`linear-gradient(90deg, ${r.primary}, ${r.secondary})`,transition:"width 0.5s ease",position:"relative",overflow:"hidden"},children:n>0&&(0,w.jsx)("div",{style:{position:"absolute",top:0,left:"-100%",width:"100%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent)",animation:"shine 2s infinite"}})})}),100===n?(0,w.jsx)("p",{style:{color:r.primary,margin:`${m.md} 0 0 0`,fontWeight:p.bold,textAlign:"center",fontSize:g.base,animation:"celebrate 0.5s ease"},children:"\ud83c\udf89 \xa1Felicitaciones! Has completado todos los repasos."}):(0,w.jsx)("p",{style:{color:r.lightText,margin:`${m.md} 0 0 0`,fontSize:g.sm,lineHeight:h.relaxed},children:0===i?"\xa1Comienza tu primer repaso hoy!":"\xa1Excelente progreso! Contin\xfaa con el siguiente repaso."})]}),(0,w.jsx)("style",{children:"\n        @keyframes shine {\n          0% { left: -100%; }\n          100% { left: 200%; }\n        }\n        \n        @keyframes celebrate {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.05); }\n        }\n\n        @media (prefers-reduced-motion: reduce) {\n          @keyframes shine {\n            0%, 100% { left: 0; opacity: 0.5; }\n            50% { opacity: 1; }\n          }\n          \n          @keyframes celebrate {\n            0%, 100% { transform: scale(1); }\n          }\n        }\n      "})]})})),G=r.memo((e=>{let{cronograma:t,notasRepasadas:o,theme:r,marcarRepasoCompletado:a}=e;if(!t||0===t.length)return(0,w.jsx)("div",{style:{marginTop:"30px",textAlign:"center",padding:"20px",color:r.lightText},children:(0,w.jsx)("p",{children:"No hay cronograma de repaso disponible."})});const i=new Date,n=t.filter(((e,t)=>new Date(e.fecha).toDateString()===i.toDateString()&&!e.completado&&!o[t]));t.filter(((e,t)=>e.completado||o[t])),t.filter(((e,t)=>!e.completado&&!o[t]&&new Date(e.fecha).toDateString()!==i.toDateString()));return(0,w.jsxs)("div",{style:{marginTop:m.xl},children:[(0,w.jsx)("h3",{style:{color:r.text,display:"flex",alignItems:"center",gap:m.sm,fontSize:g.xl,fontWeight:p.bold,marginBottom:m.md},children:"\ud83d\udd04 Cronograma de Repaso Espaciado"}),(0,w.jsx)("p",{style:{color:r.lightText,marginBottom:m.xl,fontSize:g.base,lineHeight:h.relaxed},children:"Basado en la curva del olvido para optimizar la retenci\xf3n a largo plazo. Sigue el cronograma para maximizar tu aprendizaje."}),(0,w.jsx)(K,{cronograma:t,notasRepasadas:o,theme:r}),n.length>0&&(0,w.jsxs)("div",{style:{marginBottom:m.xxl},children:[(0,w.jsxs)("h4",{style:{color:r.accent,margin:`0 0 ${m.lg} 0`,display:"flex",alignItems:"center",gap:m.sm,fontSize:g.lg,fontWeight:p.semibold},children:["\u2b50 Repasos para Hoy (",n.length,")"]}),(0,w.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:m.md,maxWidth:S.md,margin:"0 auto"},children:n.map(((e,o)=>{const i=t.findIndex((t=>t===e));return(0,w.jsx)(L,{repaso:e,index:i,esHoy:!0,completado:!1,theme:r,onMarcarCompletado:a},`hoy-${i}`)}))})]}),(0,w.jsxs)("div",{style:{marginBottom:m.xl},children:[(0,w.jsx)("h4",{style:{color:r.text,margin:`0 0 ${m.lg} 0`,display:"flex",alignItems:"center",gap:m.sm,fontSize:g.lg,fontWeight:p.semibold},children:"\ud83d\udcc5 Cronograma Completo"}),(0,w.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:m.md,maxWidth:S.md,margin:"0 auto"},children:t.map(((e,t)=>{const n=new Date(e.fecha).toDateString()===i.toDateString(),s=e.completado||o[t];return(0,w.jsx)(L,{repaso:e,index:t,esHoy:n,completado:s,theme:r,onMarcarCompletado:a},t)}))})]}),(0,w.jsxs)("div",{style:{backgroundColor:r.cardBg,borderRadius:x.lg,padding:m.lg,border:`${f.normal} solid ${r.border}`,marginTop:m.xl,boxShadow:y.sm},children:[(0,w.jsx)("h4",{style:{color:r.text,margin:`0 0 ${m.md} 0`,fontSize:g.lg,fontWeight:p.semibold,display:"flex",alignItems:"center",gap:m.sm},children:"\ud83d\udca1 Consejos para el Repaso Efectivo"}),(0,w.jsxs)("ul",{style:{color:r.lightText,fontSize:g.sm,margin:0,paddingLeft:m.lg,lineHeight:h.relaxed},children:[(0,w.jsx)("li",{style:{marginBottom:m.sm},children:"Revisa las notas sin mirar las respuestas primero"}),(0,w.jsx)("li",{style:{marginBottom:m.sm},children:"Intenta recordar los conceptos clave de memoria"}),(0,w.jsx)("li",{style:{marginBottom:m.sm},children:"Si olvidas algo, no te preocupes: es parte del proceso"}),(0,w.jsx)("li",{style:{marginBottom:m.sm},children:"Marca como completado solo despu\xe9s de revisar todo el material"}),(0,w.jsx)("li",{children:"La consistencia es m\xe1s importante que la perfecci\xf3n"})]})]})]})}));var Y=o(4752);const{scheduleNext:J,getDueItems:q,updateStudyItem:X,validateQuality:Q,createStudyItem:V}=o(3158);const Z=new class{constructor(){this._cache=new Map,this._subscribers=new Map,this._persistTimers=new Map}_reset(){this._persistTimers.forEach((e=>clearTimeout(e))),this._persistTimers.clear(),this._cache.clear(),this._subscribers.clear()}computeKeyFromText(e){return e&&e.trim()?`studyitems:${function(e){let t=0,o=0,r=e.length;for(;o<r;)t=(t<<5)-t+e.charCodeAt(o++)|0;return(t>>>0).toString(36)}(e)}:v1`:null}_ensureEntry(e){if(!this._cache.has(e)){let t=[];if("undefined"!==typeof localStorage){const o=localStorage.getItem(e);if(o){const e=function(e){try{return JSON.parse(e)}catch{return null}}(o);e&&Array.isArray(e.items)&&(t=e.items)}}this._cache.set(e,{items:t,dirty:!1})}return this._cache.get(e)}_persistNow(e){const t=this._cache.get(e);if(t&&t.dirty)try{const o=JSON.stringify({version:1,items:t.items});localStorage.setItem(e,o),t.dirty=!1}catch(o){console.warn("[StudyItemsService] Persistencia fallida, manteniendo en memoria.",o)}}_schedulePersist(e){if(this._persistTimers.has(e))return;const t=setTimeout((()=>{this._persistTimers.delete(e),this._persistNow(e)}),150);this._persistTimers.set(e,t)}_markDirty(e){const t=this._cache.get(e);t&&(t.dirty=!0,this._schedulePersist(e))}_emit(e){const t=this._subscribers.get(e);if(t){const o=this.list(e);t.forEach((e=>{try{e(o)}catch{}}))}}subscribe(e,t){return e&&"function"===typeof t?(this._subscribers.has(e)||this._subscribers.set(e,new Set),this._subscribers.get(e).add(t),t(this.list(e)),()=>{const o=this._subscribers.get(e);o&&(o.delete(t),o.size||this._subscribers.delete(e))}):()=>{}}list(e){return this._ensureEntry(e).items.map((e=>({...e})))}addItems(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||!Array.isArray(t)||!t.length)return[];const o=this._ensureEntry(e),r=new Set(o.items.map((e=>`${e.content}::${e.dimension}`))),a=[];for(const i of t){const e=`${i.content}::${i.dimension}`;r.has(e)||(o.items.push(i),r.add(e),a.push(i))}return a.length&&(this._markDirty(e),this._emit(e)),a}updateItem(e,t,o){const r=this._ensureEntry(e),a=r.items.findIndex((e=>e.itemId===t));if(-1===a)return null;try{Q(o)}catch{return null}const i=J(r.items[a],o),n=X(i,o,{dueDate:i.dueDate});return r.items[a]=n,this._markDirty(e),this._emit(e),n}getDue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;const o=this._ensureEntry(e);return q(o.items,t)}flush(e){this._persistTimers.has(e)&&(clearTimeout(this._persistTimers.get(e)),this._persistTimers.delete(e)),this._persistNow(e)}};var ee=o(9877);const te=function(e){const t=(0,r.useMemo)((()=>{if(!e||!e.trim())return null;const t=ee.Qr.computeKeyFromText(e);if(!t)return null;return`studyitems:${t.split(":")[1]}:v1`}),[e]),[o,a]=(0,r.useState)([]);(0,r.useEffect)((()=>{if(!t)return;return Z.subscribe(t,a)}),[t]);const i=(0,r.useMemo)((()=>Z.getDue(t)),[o,t]),n=(0,r.useCallback)((e=>t?Z.addItems(t,e):[]),[t]),s=(0,r.useCallback)(((e,o)=>t?Z.updateItem(t,e,o):null),[t]);return{storageKey:t,items:o,dueItems:i,addItems:n,reviewItem:s}},oe=Y.Ay.div`
  background: ${e=>e.theme.surface};
  border: 1px solid ${e=>e.theme.border};
  border-radius: 10px;
  padding: 1rem 1.25rem;
  margin-top: 1.25rem;
`,re=Y.Ay.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
`,ae=Y.Ay.div`
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 0.75rem;
  align-items: center;
`,ie=Y.Ay.select`
  background: ${e=>e.theme.cardBg};
  border: 1px solid ${e=>e.theme.border};
  color: ${e=>e.theme.text};
  font-size: 0.7rem;
  padding: 0.25rem 0.4rem;
  border-radius: 4px;
`,ne=Y.Ay.button`
  background: ${e=>e.$active?e.theme.primary:e.theme.cardBg};
  border: 1px solid ${e=>e.theme.border};
  color: ${e=>e.$active?"#fff":e.theme.text};
  font-size: 0.65rem;
  padding: 0.3rem 0.5rem;
  border-radius: 4px;
  cursor: pointer;
  &:hover { opacity: 0.85; }
`,se=Y.Ay.div`
  width: 100%;
  height: 6px;
  background: ${e=>e.theme.border};
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
`,le=Y.Ay.div`
  height: 100%;
  background: linear-gradient(90deg, ${e=>e.theme.primary}, ${e=>e.theme.secondary});
  width: ${e=>e.$pct}%;
  transition: width 0.4s ease;
`,de=Y.Ay.ul`
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
  max-height: 260px;
  overflow-y: auto;
`,ce=Y.Ay.li`
  background: ${e=>e.theme.cardBg};
  border: 1px solid ${e=>e.theme.border};
  border-radius: 8px;
  padding: 0.6rem 0.75rem;
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
`,me=Y.Ay.div`
  font-size: 0.85rem;
  line-height: 1.3;
  color: ${e=>e.theme.text};
`,ge=Y.Ay.div`
  display: flex;
  justify-content: space-between;
  font-size: 0.65rem;
  opacity: 0.8;
  color: ${e=>e.theme.textMuted};
`,pe=Y.Ay.div`
  display: flex;
  gap: 0.4rem;
`,he=Y.Ay.button`
  background: ${e=>e.$q>=4?e.theme.primary:e.$q<=1?e.theme.danger||"#c0392b":e.theme.surfaceHover};
  border: none;
  color: #fff;
  padding: 0.3rem 0.5rem;
  font-size: 0.65rem;
  border-radius: 4px;
  cursor: pointer;
  opacity: 0.9;
  &:hover { opacity: 1; }
`;function ue(e){let{texto:t,theme:o}=e;const{dueItems:a,items:i,reviewItem:n}=te(t),[s,l]=(0,r.useState)("all"),[d,c]=(0,r.useState)(!1),m=(0,r.useMemo)((()=>{const e=new Set(i.map((e=>e.dimension)));return Array.from(e).sort()}),[i]),g=(0,r.useMemo)((()=>i.filter((e=>e.reviewCount>0)).length),[i]),p=(0,r.useMemo)((()=>i.length?g/i.length*100:0),[i,g]),h=(0,r.useMemo)((()=>(d?i:a).filter((e=>"all"===s||e.dimension===s))),[i,a,d,s]);return t&&i.length?(0,w.jsxs)(oe,{theme:o,children:[(0,w.jsxs)(re,{children:[(0,w.jsx)("h4",{style:{margin:0,fontSize:"0.95rem",color:o.text},children:"\ud83e\udde0 Repaso Espaciado"}),(0,w.jsxs)("span",{style:{fontSize:"0.65rem",color:o.textMuted},children:[a.length," pendientes / ",i.length," total"]})]}),(0,w.jsx)(se,{theme:o,children:(0,w.jsx)(le,{theme:o,$pct:p})}),(0,w.jsxs)(ae,{children:[(0,w.jsxs)(ie,{theme:o,value:s,onChange:e=>l(e.target.value),children:[(0,w.jsx)("option",{value:"all",children:"Todas las dimensiones"}),m.map((e=>(0,w.jsx)("option",{value:e,children:e},e)))]}),(0,w.jsx)(ne,{type:"button",theme:o,$active:d,onClick:()=>c((e=>!e)),children:d?"Mostrar pendientes":"Ver todos"})]}),0===h.length&&(0,w.jsx)("div",{style:{fontSize:"0.7rem",color:o.textMuted,padding:"0.25rem 0"},children:d?"No hay items revisados en este filtro.":"No hay items pendientes en este filtro."}),(0,w.jsx)(de,{children:h.slice(0,18).map((e=>(0,w.jsxs)(ce,{theme:o,children:[(0,w.jsx)(me,{children:e.content}),(0,w.jsxs)(ge,{theme:o,children:[(0,w.jsx)("span",{children:e.dimension}),(0,w.jsxs)("span",{children:["EF ",e.ef.toFixed(2)," \xb7 R",e.repetition]})]}),(0,w.jsx)(pe,{children:[0,1,2,3,4,5].map((t=>(0,w.jsx)(he,{theme:o,$q:t,onClick:()=>n(e.itemId,t),title:`Calidad ${t}`,children:t},t)))})]},e.itemId)))})]}):null}var xe=o(8313);const fe=()=>{const{texto:e,modoOscuro:t,completeAnalysis:o,notasAutoGeneradas:i}=(0,r.useContext)(a.BR),{notas:n,tipoTexto:s,duracionEstudio:l,cargando:d,error:b,cronograma:v,notasRepasadas:C,nivelAcademico:E,setTipoTexto:T,setDuracionEstudio:A,setNivelAcademico:_,marcarRepasoCompletado:k,regenerarNotas:I}=c(e,o),[B,O]=(0,r.useState)(!1),[P,W]=(0,r.useState)(!1),[H,M]=(0,r.useState)(!1),{dueItems:L,items:U}=te(e);(0,r.useEffect)((()=>{o&&i&&!n&&(M(!0),console.log("\ud83c\udf93 [NotasEstudio] An\xe1lisis disponible, mostrando notificaci\xf3n"))}),[o,i,n]);const K=(0,r.useMemo)((()=>({background:t?"#212121":"white",text:t?"#f5f5f5":"#333",border:t?"#616161":"#e0e0e0",shadow:t?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.1)",primary:t?"#81c784":"#4CAF50",secondary:t?"#64b5f6":"#2196F3",accent:t?"#ffb74d":"#FF9800",error:t?"#e57373":"#F44336",cardBg:t?"#333":"#f9f9f9",lightText:t?"#aaa":"#666"})),[t]),Y=(0,r.useCallback)((()=>{O((e=>!e))}),[]);return e?(0,w.jsxs)("div",{style:{backgroundColor:K.background,color:K.text,padding:"undefined"!==typeof window&&window.innerWidth<768?m.md:m.lg,borderRadius:x.lg,boxShadow:y.md,maxWidth:S.lg,margin:"0 auto"},children:[H&&!n&&o&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{style:{backgroundColor:K.secondary,color:"#fff",padding:m.lg,borderRadius:x.lg,marginBottom:m.lg,display:"flex",flexDirection:"undefined"!==typeof window&&window.innerWidth<600?"column":"row",gap:m.md,alignItems:"undefined"!==typeof window&&window.innerWidth<600?"stretch":"center",boxShadow:y.lg,animation:"slideDown 0.3s ease-out",border:`1px solid ${K.secondary}`},children:[(0,w.jsxs)("div",{style:{flex:1},children:[(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:m.sm,marginBottom:m.sm},children:[(0,w.jsx)("span",{style:{fontSize:g.xl},children:"\u2705"}),(0,w.jsx)("strong",{style:{fontSize:g.lg,fontWeight:p.bold},children:"\xa1An\xe1lisis completo disponible!"})]}),(0,w.jsx)("p",{style:{margin:0,fontSize:g.base,opacity:.95,lineHeight:h.relaxed},children:"Las notas de estudio se pueden generar usando el contexto completo del an\xe1lisis acad\xe9mico realizado."})]}),(0,w.jsxs)("div",{style:{display:"flex",gap:m.sm,flexDirection:"undefined"!==typeof window&&window.innerWidth<600?"column":"row",alignItems:"stretch"},children:[(0,w.jsx)("button",{onClick:()=>{M(!1),I()},style:{backgroundColor:"#fff",color:K.secondary,border:"none",borderRadius:x.md,padding:`${m.md} ${m.lg}`,cursor:"pointer",fontWeight:p.bold,fontSize:g.base,whiteSpace:"nowrap",boxShadow:y.md,transition:j.all,minHeight:$.button.minHeight},onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow=y.lg},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow=y.md},children:"Generar Notas Ahora"}),(0,w.jsx)("button",{onClick:()=>M(!1),style:{backgroundColor:"transparent",color:"#fff",border:`${f.normal} solid rgba(255,255,255,0.5)`,borderRadius:x.md,padding:`${m.sm} ${m.md}`,cursor:"pointer",fontSize:g.base,fontWeight:p.medium,transition:j.all,minHeight:$.button.minHeight},onMouseOver:e=>{e.target.style.backgroundColor="rgba(255,255,255,0.1)",e.target.style.borderColor="rgba(255,255,255,0.8)"},onMouseOut:e=>{e.target.style.backgroundColor="transparent",e.target.style.borderColor="rgba(255,255,255,0.5)"},children:"Ahora no"})]})]}),(0,w.jsx)("style",{children:"\n            @keyframes slideDown {\n              from {\n                opacity: 0;\n                transform: translateY(-20px);\n              }\n              to {\n                opacity: 1;\n                transform: translateY(0);\n              }\n            }\n\n            @media (prefers-reduced-motion: reduce) {\n              @keyframes slideDown {\n                from, to {\n                  opacity: 1;\n                  transform: translateY(0);\n                }\n              }\n            }\n          "})]}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:m.lg,gap:m.md,flexWrap:"wrap"},children:[(0,w.jsxs)("div",{style:{flex:1,minWidth:"250px"},children:[(0,w.jsx)("h2",{style:{color:K.text,margin:`0 0 ${m.xs} 0`,fontSize:g["2xl"],fontWeight:p.bold,lineHeight:h.tight,letterSpacing:u.tight},children:"Notas de Estudio"}),(0,w.jsx)("p",{style:{color:K.lightText,margin:0,fontSize:g.sm,fontWeight:p.normal},children:"Con aprendizaje espaciado optimizado"})]}),(0,w.jsxs)("div",{style:{display:"flex",gap:m.sm,flexWrap:"wrap"},children:[(null===U||void 0===U?void 0:U.length)>0&&(0,w.jsxs)("button",{onClick:()=>W((e=>!e)),"aria-expanded":P,style:{backgroundColor:P?K.primary:"transparent",color:P?"#fff":K.primary,border:`${f.normal} solid ${K.primary}`,borderRadius:x.md,padding:`${m.md} ${m.lg}`,cursor:"pointer",display:"flex",alignItems:"center",gap:m.sm,fontWeight:p.semibold,fontSize:g.base,minHeight:$.button.minHeight,transition:j.normal,whiteSpace:"nowrap"},children:["\ud83e\udde0 ",P?"Cerrar pr\xe1ctica":"Practicar ahora",(null===L||void 0===L?void 0:L.length)>0&&(0,w.jsx)("span",{style:{background:"#ff7043",color:"#fff",padding:`${m.xs} ${m.sm}`,borderRadius:x.full,fontSize:g.xs,fontWeight:p.bold},children:L.length})]}),(0,w.jsxs)("button",{onClick:Y,"aria-expanded":B,"aria-controls":"panel-configuracion",style:{backgroundColor:B?K.secondary:"transparent",color:B?"#fff":K.secondary,border:`${f.normal} solid ${K.secondary}`,borderRadius:x.md,padding:`${m.md} ${m.lg}`,cursor:"pointer",display:"flex",alignItems:"center",gap:m.sm,fontWeight:p.semibold,fontSize:g.base,minHeight:$.button.minHeight,transition:j.normal},children:[(0,w.jsxs)("span",{children:[B?"Ocultar":"Mostrar"," configuraci\xf3n"]}),(0,w.jsx)("span",{style:{transition:j.transform,transform:B?"rotate(180deg)":"rotate(0deg)"},children:"\u25bc"})]})]})]}),(0,w.jsx)(xe.A,{theme:K}),B&&(0,w.jsx)(N,{theme:K,tipoTexto:s,setTipoTexto:T,duracionEstudio:l,setDuracionEstudio:A,nivelAcademico:E,setNivelAcademico:_,regenerarNotas:I}),P&&(0,w.jsx)("div",{style:{marginBottom:"24px"},children:null!==U&&void 0!==U&&U.length?(0,w.jsx)(ue,{texto:e,theme:K}):(0,w.jsx)("div",{style:{border:`1px dashed ${K.border}`,padding:"12px",borderRadius:"8px",fontSize:"0.8rem",color:K.lightText},children:"A\xfan no hay items de estudio generados. Responde evaluaciones para producir mejoras convertibles en repaso."})}),d?(0,w.jsx)(z,{theme:K}):b?(0,w.jsx)(R,{error:b,onRetry:I,theme:K,modoOscuro:t}):(0,w.jsx)("div",{children:n?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(F,{notas:n,theme:K}),(0,w.jsx)(G,{cronograma:v,notasRepasadas:C,theme:K,marcarRepasoCompletado:k})]}):(0,w.jsx)("p",{style:{textAlign:"center",padding:"20px"},children:"Configurando notas de estudio..."})}),(0,w.jsx)(D,{theme:K})]}):(0,w.jsxs)("div",{style:{backgroundColor:K.background,color:K.text,padding:"20px",borderRadius:"8px",textAlign:"center"},children:[(0,w.jsx)("h2",{style:{color:K.text},children:"Notas de Estudio"}),(0,w.jsx)("p",{children:"Carga un texto para comenzar a generar notas de estudio personalizadas."})]})}},8313:(e,t,o)=>{o.d(t,{A:()=>y});var r=o(9950),a=o(4752),i=o(3291),n=o(1132),s=o(7085),l=o(4414);const d=(0,a.Ay)(n.P.div)`
  background: linear-gradient(135deg, ${e=>e.theme.error||"#dc2626"}15, ${e=>e.theme.warning||"#f59e0b"}15);
  border: 2px solid ${e=>e.theme.error||"#dc2626"};
  border-radius: 12px;
  padding: 1.25rem;
  margin-bottom: 1.5rem;
  display: flex;
  gap: 1rem;
  position: relative;
  box-shadow: 0 4px 12px ${e=>e.theme.error||"#dc2626"}20;
`,c=a.Ay.div`
  font-size: 2rem;
  flex-shrink: 0;
`,m=a.Ay.div`
  flex: 1;
`,g=a.Ay.h3`
  margin: 0 0 0.5rem 0;
  font-size: 1.1rem;
  font-weight: 700;
  color: ${e=>e.theme.error||"#dc2626"};
`,p=a.Ay.p`
  margin: 0 0 0.75rem 0;
  font-size: 0.95rem;
  line-height: 1.6;
  color: ${e=>e.theme.text||"#232B33"};
  
  strong {
    color: ${e=>e.theme.error||"#dc2626"};
    font-weight: 600;
  }
`,h=a.Ay.div`
  background: ${e=>e.theme.surface||"#FFFFFF"};
  border: 1px solid ${e=>e.theme.border||"#E4EAF1"};
  border-radius: 8px;
  padding: 0.75rem;
  margin: 0.75rem 0;
`,u=a.Ay.div`
  display: flex;
  gap: 0.5rem;
  align-items: center;
  font-size: 0.9rem;
  color: ${e=>e.theme.text||"#232B33"};
  margin: 0.5rem 0;
  
  strong {
    font-weight: 600;
    color: ${e=>e.theme.text||"#232B33"};
  }
  
  span:last-child {
    color: ${e=>e.theme.textMuted||"#607D8B"};
    font-size: 0.85rem;
  }
`,x=a.Ay.div`
  font-size: 0.9rem;
  color: ${e=>e.theme.text||"#232B33"};
  padding: 0.75rem;
  background: ${e=>e.theme.success||"#009688"}15;
  border-left: 3px solid ${e=>e.theme.success||"#009688"};
  border-radius: 4px;
  margin-top: 0.75rem;
  
  strong {
    color: ${e=>e.theme.success||"#009688"};
  }
`,f=a.Ay.button`
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  background: none;
  border: none;
  font-size: 1.5rem;
  color: ${e=>e.theme.textMuted||"#607D8B"};
  cursor: pointer;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.2s;
  
  &:hover {
    background: ${e=>e.theme.border||"#E4EAF1"};
    color: ${e=>e.theme.text||"#232B33"};
  }
`,y=e=>{let{theme:t}=e;const[o,a]=(0,r.useState)(!1),[n,y]=(0,r.useState)([]),[b,v]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{const e=()=>{const e=(0,s.x)();a(e.hasDrafts),y(e.details),e.hasDrafts||v(!0)};e();const t=setInterval(e,2e3),o=t=>{var o,r,a,i;("rubricProgress"===t.key||null!==(o=t.key)&&void 0!==o&&o.includes("_draft")||null!==(r=t.key)&&void 0!==r&&r.includes("ACD_")||null!==(a=t.key)&&void 0!==a&&a.includes("Actores_")||null!==(i=t.key)&&void 0!==i&&i.includes("Argumentativa_"))&&e()},r=()=>{console.log("\u2705 [DraftWarning] Evaluaci\xf3n completada, re-verificando borradores..."),e()};return window.addEventListener("storage",o),window.addEventListener("evaluation-complete",r),()=>{clearInterval(t),window.removeEventListener("storage",o),window.removeEventListener("evaluation-complete",r)}}),[]),o&&b?(0,l.jsx)(i.N,{children:(0,l.jsxs)(d,{theme:t,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[(0,l.jsx)(c,{children:"\u26a0\ufe0f"}),(0,l.jsxs)(m,{theme:t,children:[(0,l.jsx)(g,{theme:t,children:"Advertencia: Borradores sin Evaluar"}),(0,l.jsxs)(p,{theme:t,children:["Tienes borradores sin evaluar en los siguientes artefactos.",(0,l.jsx)("strong",{children:" Si cambias de sesi\xf3n o cargas un nuevo documento, estos borradores se perder\xe1n permanentemente."})]}),(0,l.jsx)(h,{theme:t,children:n.map(((e,o)=>(0,l.jsxs)(u,{theme:t,children:[(0,l.jsx)("span",{children:"\u2022"}),(0,l.jsx)("strong",{children:e.artefacto}),(0,l.jsxs)("span",{children:["\u2192 ",e.ubicacion]})]},o)))}),(0,l.jsxs)(x,{theme:t,children:["\ud83d\udca1 ",(0,l.jsx)("strong",{children:"Recomendaci\xf3n:"})," Eval\xfaa estos artefactos antes de cambiar de sesi\xf3n para guardar tu progreso."]})]}),(0,l.jsx)(f,{theme:t,onClick:()=>v(!1),title:"Cerrar advertencia",children:"\xd7"})]})}):null}},9877:(e,t,o)=>{o.d(t,{Qr:()=>r});const r=new class{constructor(){this._cache=new Map,this._subscribers=new Map,this._persistTimers=new Map}_reset(){this._persistTimers.forEach((e=>clearTimeout(e))),this._persistTimers.clear(),this._cache.clear(),this._subscribers.clear()}_ensureEntry(e){if(!this._cache.has(e)){let t=[];if("undefined"!==typeof localStorage){const o=localStorage.getItem(e);if(o){const e=function(e){try{return JSON.parse(e)}catch{return null}}(o);e&&Array.isArray(e.items)&&(t=e.items)}}this._cache.set(e,{items:t,dirty:!1})}return this._cache.get(e)}_persistNow(e){const t=this._cache.get(e);if(t&&t.dirty)try{const o=JSON.stringify({version:1,items:t.items});localStorage.setItem(e,o),t.dirty=!1}catch(o){console.warn("[AnnotationsService] Persistencia fallida, manteniendo en memoria.",o)}}_schedulePersist(e){if(this._persistTimers.has(e))return;const t=setTimeout((()=>{this._persistTimers.delete(e),this._persistNow(e)}),120);this._persistTimers.set(e,t)}_markDirtyAndSchedule(e){const t=this._cache.get(e);t&&(t.dirty=!0,this._schedulePersist(e))}_emit(e){const t=this._subscribers.get(e);if(t){const o=this.listByStorageKey(e);t.forEach((e=>{try{e(o)}catch{}}))}}_makeId(){return Math.random().toString(36).slice(2,10)}computeKeyFromText(e){return e&&e.trim()?`annotations:${function(e){let t=0,o=0,r=e.length;for(;o<r;)t=(t<<5)-t+e.charCodeAt(o++)|0;return(t>>>0).toString(36)}(e)}:v1`:null}subscribe(e,t){return e&&"function"===typeof t?(this._subscribers.has(e)||this._subscribers.set(e,new Set),this._subscribers.get(e).add(t),t(this.listByStorageKey(e)),()=>{const o=this._subscribers.get(e);o&&(o.delete(t),o.size||this._subscribers.delete(e))}):()=>{}}listByStorageKey(e){return this._ensureEntry(e).items.map((e=>({...e,meta:{...e.meta}})))}listHighlights(e){return this.listByStorageKey(e).filter((e=>"highlight"===e.kind))}listNotes(e){return this.listByStorageKey(e).filter((e=>"note"===e.kind))}addHighlight(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"manual";if(null==t)throw new Error("paragraphIndex requerido");const a=this._ensureEntry(e),i=Date.now(),n={id:this._makeId(),kind:"highlight",paragraphIndex:t,text:o||void 0,meta:{createdAt:i,updatedAt:i,source:r}};return a.items.push(n),this._markDirtyAndSchedule(e),this._emit(e),n}toggleHighlight(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"manual";const r=this._ensureEntry(e),a=r.items.findIndex((e=>"highlight"===e.kind&&e.paragraphIndex===t));if(a>=0){const[t]=r.items.splice(a,1);return this._markDirtyAndSchedule(e),this._emit(e),{removed:t,active:!1}}return{added:this.addHighlight(e,t,void 0,o),active:!0}}addNote(e){let{paragraphIndex:t=null,text:o="",source:r="manual",meta:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=this._ensureEntry(e),n=Date.now(),s={id:this._makeId(),kind:"note",paragraphIndex:null==t?void 0:t,text:o,meta:{createdAt:n,updatedAt:n,source:r,...a||{}}};return i.items.push(s),this._markDirtyAndSchedule(e),this._emit(e),s}updateAnnotation(e,t,o){const r=this._ensureEntry(e),a=r.items.findIndex((e=>e.id===t));if(-1===a)return null;const i=Date.now(),n=r.items[a],s={...n,...o,meta:{...n.meta,updatedAt:i}};return r.items[a]=s,this._markDirtyAndSchedule(e),this._emit(e),s}removeAnnotation(e,t){const o=this._ensureEntry(e),r=o.items.findIndex((e=>e.id===t));return-1!==r&&(o.items.splice(r,1),this._markDirtyAndSchedule(e),this._emit(e),!0)}clearAll(e){this._ensureEntry(e).items=[],this._markDirtyAndSchedule(e),this._emit(e)}addAnchor(e,t){let{paragraphIndex:o,anchorType:r,refId:a,data:i,source:n="auto"}=t;if(null==o)throw new Error("paragraphIndex requerido para anchor");const s=this._ensureEntry(e),l=Date.now(),d={id:this._makeId(),kind:"anchor",paragraphIndex:o,text:void 0,meta:{createdAt:l,updatedAt:l,source:n,anchorType:r,refId:a,data:i}};return s.items.push(d),this._markDirtyAndSchedule(e),this._emit(e),d}listAnchors(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{anchorType:o}=t;return this.listByStorageKey(e).filter((e=>{var t;return"anchor"===e.kind&&(!o||(null===(t=e.meta)||void 0===t?void 0:t.anchorType)===o)}))}toExportBundle(e){const t=this.listByStorageKey(e);return{version:1,highlights:t.filter((e=>"highlight"===e.kind)),notes:t.filter((e=>"note"===e.kind)),anchors:t.filter((e=>"anchor"===e.kind))}}flush(e){this._persistTimers.has(e)&&(clearTimeout(this._persistTimers.get(e)),this._persistTimers.delete(e)),this._persistNow(e)}}}}]);